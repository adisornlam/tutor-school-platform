import{_ as D}from"./0JwXLbdW.js";import{d as S,m as V,p as I,l as R,r as p,B as F,o as A,c as a,b as t,v as i,e as s,t as r,n as u,F as v,i as _,j as O,a as d,f as q,w as G,g as J}from"./CX4WDIMJ.js";import{f as K}from"./BALXvQ8s.js";import{t as P}from"./CiM0_A9B.js";const Q={class:"flex items-center justify-between mb-6"},U={class:"flex items-center space-x-4"},W={class:"flex items-center space-x-3"},X={key:0,class:"text-center py-12"},Y={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},Z={key:2,class:"space-y-6"},tt={key:0,class:"bg-white rounded-lg shadow p-6"},et={class:"flex justify-center"},st=["src","alt"],ot={class:"bg-white rounded-lg shadow p-6"},nt={class:"flex items-center justify-between mb-6"},rt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},lt={class:"md:col-span-2"},at={class:"text-lg font-medium text-gray-900"},dt={class:"text-gray-900"},it={class:"text-lg font-medium text-gray-900"},ct={class:"text-gray-900"},ut={class:"text-gray-900"},mt={class:"text-gray-900"},xt={class:"text-gray-900"},gt={class:"text-gray-900"},pt={key:0,class:"md:col-span-2 lg:col-span-3"},yt=["innerHTML"],bt={key:1,class:"bg-white rounded-lg shadow p-6"},vt={class:"text-xl font-semibold mb-4"},_t={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ht={class:"flex items-start justify-between"},ft={class:"flex-1"},kt={class:"text-lg font-medium text-gray-900"},wt={key:0,class:"text-sm text-gray-500 mt-1"},Ct={class:"mt-3 space-y-1"},Nt={class:"flex items-center justify-between text-sm"},Mt={class:"font-medium text-gray-900"},Bt={class:"flex items-center justify-between text-sm"},$t={class:"font-medium text-gray-900"},jt={class:"flex items-center justify-between text-sm"},Ht={key:2,class:"bg-white rounded-lg shadow p-6"},Lt={key:3,class:"bg-white rounded-lg shadow p-6"},Tt={class:"text-xl font-semibold mb-4"},Et={class:"overflow-x-auto"},zt={class:"min-w-full divide-y divide-gray-200"},Dt={class:"bg-white divide-y divide-gray-200"},St={class:"px-4 py-3"},Vt=["onClick"],It={class:"text-xs text-gray-500"},Rt={class:"px-4 py-3 text-sm text-gray-900"},Ft={class:"px-4 py-3"},At={class:"px-4 py-3 text-sm text-gray-500"},Ot={class:"px-4 py-3 text-right"},qt={key:4,class:"bg-white rounded-lg shadow p-6"},Wt=S({__name:"index",setup(Gt){const h=V(),y=I(),f=O(),{accessToken:k,user:m}=R(),b=parseInt(h.params.id),x=p(!0),c=p(""),n=p(null),w=F(()=>{if(!m.value||!m.value.roles)return!1;const o=["system_admin","owner","admin","branch_admin"];return m.value.roles.some(e=>o.includes(e))}),C=async()=>{x.value=!0,c.value="";try{const o=await $fetch(`${f.public.apiBase}/admin/courses/${b}`,{headers:{Authorization:`Bearer ${k.value}`}});o.success&&(n.value=o.data)}catch(o){console.error("Error loading course detail:",o),c.value=o.data?.message||"เกิดข้อผิดพลาดในการโหลดข้อมูล"}finally{x.value=!1}},N=o=>({live_online:"Live Online",vod:"VOD",hybrid:"Hybrid"})[o]||o,M=o=>({live_online:"bg-blue-100 text-blue-800",vod:"bg-purple-100 text-purple-800",hybrid:"bg-indigo-100 text-indigo-800"})[o]||"bg-gray-100 text-gray-800",B=o=>({draft:"ร่าง",published:"เผยแพร่",archived:"เก็บถาวร"})[o]||o,$=o=>({draft:"bg-gray-100 text-gray-800",published:"bg-green-100 text-green-800",archived:"bg-yellow-100 text-yellow-800"})[o]||"bg-gray-100 text-gray-800",j=o=>({beginner:"เริ่มต้น",intermediate:"กลาง",advanced:"สูง"})[o]||o,H=o=>({active:"ใช้งาน",completed:"เสร็จสิ้น",cancelled:"ยกเลิก"})[o]||o,L=o=>({active:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800"})[o]||"bg-gray-100 text-gray-800",T=o=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(o),g=o=>K(new Date(o),"dd MMM yyyy",{locale:P}),E=o=>{const e=o.target;e.style.display="none"};return A(()=>{C()}),(o,e)=>{const z=D;return d(),a("div",null,[t("div",Q,[t("div",U,[t("button",{onClick:e[0]||(e[0]=l=>o.$router.back()),class:"p-2 hover:bg-gray-100 rounded-lg"},[...e[2]||(e[2]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),e[3]||(e[3]=t("h1",{class:"text-3xl font-bold"},"รายละเอียดคอร์ส",-1))]),t("div",W,[s(w)?(d(),a("button",{key:0,onClick:e[1]||(e[1]=l=>s(y).push(`/admin/courses/${s(b)}/edit`)),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2"},[...e[4]||(e[4]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),t("span",null,"แก้ไข",-1)])])):i("",!0)])]),s(x)?(d(),a("div",X,[...e[5]||(e[5]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"},null,-1),t("p",{class:"mt-4 text-gray-600"},"กำลังโหลดข้อมูล...",-1)])])):s(c)?(d(),a("div",Y,r(s(c)),1)):s(n)?(d(),a("div",Z,[s(n).course.thumbnail_url?(d(),a("div",tt,[e[6]||(e[6]=t("h2",{class:"text-xl font-semibold mb-4"},"รูปภาพปก",-1)),t("div",et,[t("img",{src:s(n).course.thumbnail_url,alt:s(n).course.title,class:"max-w-full h-auto rounded-lg shadow-md",style:{"max-height":"400px"},onError:E},null,40,st)])])):i("",!0),t("div",ot,[t("div",nt,[e[7]||(e[7]=t("h2",{class:"text-xl font-semibold"},"ข้อมูลคอร์ส",-1)),t("span",{class:u(["px-3 py-1 text-sm font-medium rounded",$(s(n).course.status)])},r(B(s(n).course.status)),3)]),t("div",rt,[t("div",lt,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"ชื่อคอร์ส",-1)),t("p",at,r(s(n).course.title),1)]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"รหัสคอร์ส",-1)),t("p",dt,r(s(n).course.code||"-"),1)]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"ประเภท",-1)),t("span",{class:u(["px-2 py-1 text-xs font-medium rounded",M(s(n).course.type)])},r(N(s(n).course.type)),3)]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"ราคา",-1)),t("p",it,r(T(s(n).course.price)),1)]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"ระยะเวลา",-1)),t("p",ct,r(s(n).course.duration_hours?`${s(n).course.duration_hours} ชั่วโมง`:"-"),1)]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"ระดับ",-1)),t("p",ut,r(s(n).course.level?j(s(n).course.level):"-"),1)]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"วันที่สร้าง",-1)),t("p",mt,r(g(s(n).course.created_at)),1)]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"อัปเดตล่าสุด",-1)),t("p",xt,r(g(s(n).course.updated_at)),1)]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"สร้างโดย",-1)),t("p",gt,r(s(n).course.created_by_name?`${s(n).course.created_by_name} ${s(n).course.created_by_last_name||""}`:"-"),1)]),s(n).course.description?(d(),a("div",pt,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"คำอธิบาย",-1)),t("div",{class:"text-gray-900 prose max-w-none",innerHTML:s(n).course.description},null,8,yt)])):i("",!0)])]),s(n).branches&&s(n).branches.length>0?(d(),a("div",bt,[t("h2",vt,"สาขาที่เปิดสอน ("+r(s(n).branches.length)+")",1),t("div",_t,[(d(!0),a(v,null,_(s(n).branches,l=>(d(),a("div",{key:l.branch_id,class:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50"},[t("div",ht,[t("div",ft,[t("h3",kt,r(l.branch_name),1),l.branch_code?(d(),a("p",wt,"รหัส: "+r(l.branch_code),1)):i("",!0),t("div",Ct,[t("div",Nt,[e[18]||(e[18]=t("span",{class:"text-gray-600"},"จำนวนที่นั่ง:",-1)),t("span",Mt,r(l.seat_limit?l.seat_limit.toLocaleString():"ไม่จำกัด"),1)]),t("div",Bt,[e[19]||(e[19]=t("span",{class:"text-gray-600"},"ผู้ลงทะเบียนแล้ว:",-1)),t("span",$t,r(l.current_enrollments||0),1)]),t("div",jt,[e[20]||(e[20]=t("span",{class:"text-gray-600"},"สถานะ:",-1)),t("span",{class:u(["px-2 py-1 text-xs font-medium rounded",l.is_available?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},r(l.is_available?"พร้อมใช้งาน":"ปิดใช้งาน"),3)])])])])]))),128))])])):(d(),a("div",Ht,[...e[21]||(e[21]=[t("div",{class:"text-center py-8 text-gray-500"},[t("svg",{class:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})]),t("p",null,"ยังไม่มีสาขาที่เปิดสอน")],-1)])])),s(n).enrollments&&s(n).enrollments.length>0?(d(),a("div",Lt,[t("h2",Tt,"ผู้เรียนที่ลงทะเบียน ("+r(s(n).enrollments.length)+")",1),t("div",Et,[t("table",zt,[e[23]||(e[23]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"ผู้เรียน"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"สาขา"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"สถานะ"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"วันที่ลงทะเบียน"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"จัดการ")])],-1)),t("tbody",Dt,[(d(!0),a(v,null,_(s(n).enrollments,l=>(d(),a("tr",{key:l.id,class:"hover:bg-gray-50"},[t("td",St,[t("div",null,[t("div",{class:"text-sm font-medium text-green-600 hover:text-green-700 cursor-pointer",onClick:Jt=>s(y).push(`/admin/students/${l.student.id}`)},r(l.student.first_name)+" "+r(l.student.last_name),9,Vt),t("div",It,r(l.student.username),1)])]),t("td",Rt,r(l.branch.name),1),t("td",Ft,[t("span",{class:u(["px-2 py-1 text-xs font-medium rounded",L(l.status)])},r(H(l.status)),3)]),t("td",At,r(g(l.enrolled_at)),1),t("td",Ot,[q(z,{to:`/admin/enrollments/${l.id}`,class:"text-green-600 hover:text-green-700 text-sm font-medium"},{default:G(()=>[...e[22]||(e[22]=[J(" ดูรายละเอียด ",-1)])]),_:1},8,["to"])])]))),128))])])])])):(d(),a("div",qt,[...e[24]||(e[24]=[t("div",{class:"text-center py-8 text-gray-500"},[t("svg",{class:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})]),t("p",null,"ยังไม่มีผู้เรียนลงทะเบียนในคอร์สนี้")],-1)])]))])):i("",!0)])}}});export{Wt as default};
