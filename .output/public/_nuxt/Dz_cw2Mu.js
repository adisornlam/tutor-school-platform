import{d as j,l as I,q as S,r as g,E as A,c,v as C,b as e,t as b,s as _,x as h,g as T,y as w,e as o,a,j as V,o as L,k as D,F as H,i as q,M as N}from"./CX4WDIMJ.js";const P={class:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},F={class:"flex items-center justify-between mb-6"},O={class:"text-2xl font-bold"},R={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},G={class:"md:col-span-2"},J={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},K={class:"flex justify-end space-x-3 pt-4"},Q=["disabled"],W={key:0},X={key:1},Y=j({__name:"InclusionModal",props:{show:{type:Boolean},inclusion:{default:null}},emits:["close","saved"],setup(k,{emit:$}){const x=k,f=$,v=V(),{accessToken:m}=I(),s=S({code:"",name:"",description:"",icon:""}),u=g(!1),p=g("");A(()=>x.inclusion,r=>{r?(s.code=r.code,s.name=r.name,s.description=r.description||"",s.icon=r.icon||""):(s.code="",s.name="",s.description="",s.icon=""),p.value=""},{immediate:!0});const y=async()=>{u.value=!0,p.value="";try{const r={code:s.code,name:s.name,description:s.description||null,icon:s.icon||null};x.inclusion?await $fetch(`${v.public.apiBase}/admin/settings/inclusions/${x.inclusion.id}`,{method:"PUT",headers:{Authorization:`Bearer ${m.value}`},body:r}):await $fetch(`${v.public.apiBase}/admin/settings/inclusions`,{method:"POST",headers:{Authorization:`Bearer ${m.value}`},body:r}),f("saved"),f("close")}catch(r){console.error("Error saving inclusion:",r),p.value=r.data?.message||"เกิดข้อผิดพลาดในการบันทึกข้อมูล"}finally{u.value=!1}};return(r,t)=>k.show?(a(),c("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:t[6]||(t[6]=_(l=>r.$emit("close"),["self"]))},[e("div",P,[e("div",F,[e("h2",O,b(k.inclusion?"แก้ไขสิ่งที่ได้รับ":"เพิ่มสิ่งที่ได้รับ"),1),e("button",{onClick:t[0]||(t[0]=l=>r.$emit("close")),class:"text-gray-400 hover:text-gray-600"},[...t[7]||(t[7]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:_(y,["prevent"]),class:"space-y-4"},[e("div",R,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[T(" รหัส "),e("span",{class:"text-red-500"},"*")],-1)),h(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>o(s).code=l),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[w,o(s).code]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[T(" ชื่อ "),e("span",{class:"text-red-500"},"*")],-1)),h(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>o(s).name=l),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[w,o(s).name]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," ไอคอน (Icon) ",-1)),h(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>o(s).icon=l),type:"text",placeholder:"เช่น: book, gift",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[w,o(s).icon]])]),e("div",G,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," รายละเอียด ",-1)),h(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=l=>o(s).description=l),rows:"3",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[w,o(s).description]])])]),o(p)?(a(),c("div",J,b(o(p)),1)):C("",!0),e("div",K,[e("button",{type:"button",onClick:t[5]||(t[5]=l=>r.$emit("close")),class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100"}," ยกเลิก "),e("button",{type:"submit",disabled:o(u),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed"},[o(u)?(a(),c("span",W,"กำลังบันทึก...")):(a(),c("span",X,"บันทึก"))],8,Q)])],32)])])):C("",!0)}}),Z=Object.assign(Y,{__name:"InclusionModal"}),ee={class:"flex items-center justify-between mb-6"},te={class:"bg-white rounded-lg shadow p-4 mb-6"},se={class:"bg-white rounded-lg shadow overflow-hidden"},oe={key:0,class:"p-8 text-center"},ne={key:1,class:"p-4 bg-red-50 border border-red-200 text-red-700 rounded"},re={key:2,class:"p-8 text-center text-gray-500"},le={key:3,class:"min-w-full divide-y divide-gray-200"},ie={class:"bg-white divide-y divide-gray-200"},ae={class:"px-6 py-4 whitespace-nowrap"},de={class:"text-sm font-medium text-gray-900"},ce={class:"px-6 py-4 whitespace-nowrap"},ue={class:"text-sm text-gray-900"},pe={class:"px-6 py-4"},me={class:"text-sm text-gray-500 max-w-xs truncate"},ge={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},xe={class:"flex items-center justify-end space-x-2"},fe=["onClick"],ve=["onClick"],ye=j({__name:"index",setup(k){const $=V(),{accessToken:x}=I(),f=g([]),v=g(!1),m=g(""),s=g(!1),u=g(null),p=S({search:""});let y=null;const r=()=>{y&&clearTimeout(y),y=setTimeout(()=>{t()},500)},t=async()=>{v.value=!0,m.value="";try{const d=new URLSearchParams;p.search&&d.append("search",p.search);const n=await $fetch(`${$.public.apiBase}/admin/settings/inclusions?${d.toString()}`,{headers:{Authorization:`Bearer ${x.value}`}});n.success&&(f.value=n.data)}catch(d){console.error("Error loading inclusions:",d),m.value=d.data?.message||"เกิดข้อผิดพลาดในการโหลดข้อมูล"}finally{v.value=!1}},l=d=>{u.value={...d},s.value=!1},B=()=>{s.value=!1,u.value=null},E=()=>{B(),t()},U=async d=>{const{confirm:n}=N();if(await n({title:"ยืนยันการลบ",message:`คุณแน่ใจหรือไม่ว่าต้องการลบ ${d.name}?
การกระทำนี้ไม่สามารถยกเลิกได้`,confirmText:"ลบ",cancelText:"ยกเลิก",type:"danger"}))try{await $fetch(`${$.public.apiBase}/admin/settings/inclusions/${d.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${x.value}`}}),await t()}catch(i){console.error("Error deleting inclusion:",i),alert(i.data?.message||"เกิดข้อผิดพลาดในการลบข้อมูล")}};return L(()=>{t()}),(d,n)=>{const M=Z;return a(),c("div",null,[e("div",ee,[n[3]||(n[3]=e("h1",{class:"text-3xl font-bold"},"จัดการสิ่งที่ได้รับ",-1)),e("button",{onClick:n[0]||(n[0]=i=>s.value=!0),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2"},[...n[2]||(n[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("span",null,"เพิ่มสิ่งที่ได้รับ",-1)])])]),e("div",te,[e("div",null,[n[4]||(n[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ค้นหา",-1)),h(e("input",{"onUpdate:modelValue":n[1]||(n[1]=i=>o(p).search=i),type:"text",placeholder:"ค้นหาด้วยชื่อ, รหัส, รายละเอียด",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",onInput:r},null,544),[[w,o(p).search]])])]),e("div",se,[o(v)?(a(),c("div",oe,[...n[5]||(n[5]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"},null,-1),e("p",{class:"mt-2 text-gray-600"},"กำลังโหลด...",-1)])])):o(m)?(a(),c("div",ne,b(o(m)),1)):o(f).length===0?(a(),c("div",re," ไม่พบสิ่งที่ได้รับ ")):(a(),c("table",le,[n[8]||(n[8]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"รหัส"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"ชื่อ"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"รายละเอียด"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"จัดการ")])],-1)),e("tbody",ie,[(a(!0),c(H,null,q(o(f),i=>(a(),c("tr",{key:i.id,class:"hover:bg-gray-50"},[e("td",ae,[e("div",de,b(i.code),1)]),e("td",ce,[e("div",ue,b(i.name),1)]),e("td",pe,[e("div",me,b(i.description||"-"),1)]),e("td",ge,[e("div",xe,[e("button",{onClick:_(z=>l(i),["stop"]),class:"text-blue-600 hover:text-blue-900",title:"แก้ไข"},[...n[6]||(n[6]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,fe),e("button",{onClick:_(z=>U(i),["stop"]),class:"text-red-600 hover:text-red-900",title:"ลบ"},[...n[7]||(n[7]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ve)])])]))),128))])]))]),o(s)||o(u)?(a(),D(M,{key:0,show:o(s)||!!o(u),inclusion:o(u),onClose:B,onSaved:E},null,8,["show","inclusion"])):C("",!0)])}}});export{ye as default};
