import{_ as xe}from"./BlVozWiI.js";import{_ as ye}from"./DMmjLnNd.js";import{d as ve,m as be,p as fe,l as he,r as u,q as _e,B as Q,o as ke,c as a,b as e,v as m,k as we,e as o,t as r,n as U,F as B,i as P,s as R,x,y as M,H as W,g as S,J as X,j as $e,a as l,f as Ce,w as Be,I as Pe}from"./B_rLn4hw.js";import{f as Me}from"./BALXvQ8s.js";import{t as Se}from"./CiM0_A9B.js";const je={class:"flex items-center justify-between mb-6"},Ee={class:"flex items-center space-x-4"},Ne={class:"flex items-center space-x-3"},ze={key:0,class:"text-center py-12"},He={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},Ve={key:2,class:"space-y-6"},Ae={class:"bg-white rounded-lg shadow p-6"},Ue={class:"flex items-center justify-between mb-6"},Re={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Te={class:"text-lg font-medium text-gray-900"},De={class:"text-gray-900"},Ie={class:"text-gray-900"},qe={class:"text-gray-900"},Le={class:"text-gray-900"},Fe={class:"text-gray-900"},Je={class:"bg-white rounded-lg shadow p-6"},Oe={class:"flex items-center justify-between mb-4"},Ge={key:0,class:"space-y-4"},Ke={class:"flex items-center justify-between mb-3"},Qe={class:"flex items-center space-x-3"},We={class:"text-lg font-medium text-gray-900"},Xe={class:"px-2 py-1 text-xs font-medium rounded bg-blue-100 text-blue-800"},Ye={key:0,class:"flex items-center space-x-2"},Ze=["onClick"],et={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},tt={class:"text-gray-900"},st={class:"text-gray-900"},nt={class:"text-gray-900"},ot={key:1,class:"text-center py-8 text-gray-500"},lt={class:"bg-white rounded-lg shadow p-6"},at={key:0,class:"space-y-4"},rt={class:"flex items-start justify-between"},dt={class:"flex-1"},it={class:"flex items-center space-x-3 mb-2"},ut={class:"text-lg font-medium text-gray-900"},mt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},ct={class:"ml-2 text-gray-900"},pt={class:"ml-2 text-gray-900"},gt={class:"ml-2 text-gray-900"},xt={key:1,class:"text-center py-8 text-gray-500"},yt={key:0,class:"bg-white rounded-lg shadow p-6"},vt={class:"space-y-4"},bt={class:"flex items-center justify-between mb-2"},ft={class:"font-medium text-gray-900"},ht={class:"text-sm text-gray-500"},_t={class:"w-full bg-gray-200 rounded-full h-2"},kt={class:"mt-2 text-sm text-gray-600"},wt={key:1,class:"bg-white rounded-lg shadow p-6"},$t={key:0,class:"text-center py-8"},Ct={key:1,class:"overflow-x-auto"},Bt={class:"min-w-full divide-y divide-gray-200"},Pt={class:"bg-white divide-y divide-gray-200"},Mt={class:"px-4 py-3 text-sm text-gray-900"},St={class:"px-4 py-3 text-sm font-medium text-gray-900"},jt={class:"px-4 py-3 text-sm text-gray-900"},Et={class:"px-4 py-3 text-sm text-gray-900"},Nt={key:0,class:"font-medium text-green-600"},zt={key:1,class:"text-gray-400"},Ht={class:"px-4 py-3 text-sm text-gray-900"},Vt={key:0,class:"font-medium"},At={key:1,class:"text-gray-400"},Ut={class:"px-4 py-3 text-sm"},Rt={key:2,class:"text-center py-8 text-gray-500"},Tt={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto"},Dt={key:0,class:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-lg"},It=["onClick"],qt={class:"font-medium"},Lt={class:"text-sm text-gray-500"},Ft={key:0},Jt={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},Ot={class:"flex justify-end space-x-3 pt-4"},Gt=["disabled"],Kt={key:0},Qt={key:1},Wt={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto"},Xt={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},Yt={class:"flex justify-end space-x-3 pt-4"},Zt=["disabled"],es={key:0},ts={key:1},ds=ve({__name:"index",setup(ss){const Y=be();fe();const y=$e(),{accessToken:v,user:b}=he(),j=parseInt(Y.params.id),T=u(!0),E=u(""),d=u(null),D=u([]),h=u([]),I=u(!1),N=u(!1),q=u(null),z=u(!1),p=u(""),g=u([]),f=u(null),_=u("guardian"),H=u(!1),k=u(""),c=u(null),V=u(!1),w=u(""),i=_e({first_name:"",last_name:"",email:"",phone:"",relationship:"guardian"}),L=Q(()=>{if(!b.value||!b.value.roles)return!1;const n=["system_admin","owner","admin","branch_admin"];return b.value.roles.some(t=>n.includes(t))}),F=Q(()=>{if(!b.value||!b.value.roles)return!1;const n=["system_admin","owner","admin","branch_admin"];return b.value.roles.some(t=>n.includes(t))}),A=async()=>{T.value=!0,E.value="";try{const n=await $fetch(`${y.public.apiBase}/admin/students/${j}`,{headers:{Authorization:`Bearer ${v.value}`}});n.success&&(d.value=n.data,await Promise.all([Z(),...F.value?[ee()]:[]]))}catch(n){console.error("Error loading student detail:",n),E.value=n.data?.message||"เกิดข้อผิดพลาดในการโหลดข้อมูล"}finally{T.value=!1}},Z=async()=>{},ee=async()=>{if(F.value){I.value=!0;try{const n=await $fetch(`${y.public.apiBase}/admin/students/${j}/payments`,{headers:{Authorization:`Bearer ${v.value}`}});n.success&&(h.value=n.data)}catch(n){console.error("Error loading payments:",n),h.value=[]}finally{I.value=!1}}},te=()=>{d.value&&d.value.student&&(q.value={id:d.value.student.id,username:d.value.student.username,email:d.value.student.email,first_name:d.value.student.first_name,last_name:d.value.student.last_name,phone:d.value.student.phone,status:d.value.student.status,parents:[]},N.value=!0)},J=()=>{N.value=!1,q.value=null},se=async()=>{J(),await A()},O=n=>({active:"ใช้งาน",inactive:"ปิดใช้งาน",suspended:"ระงับ"})[n]||n,G=n=>({active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",suspended:"bg-red-100 text-red-800"})[n]||"bg-gray-100 text-gray-800",ne=n=>({father:"บิดา",mother:"มารดา",guardian:"ผู้ปกครอง",other:"อื่นๆ"})[n]||n,oe=n=>({pending:"รอดำเนินการ",active:"กำลังเรียน",completed:"เรียนจบ",cancelled:"ยกเลิก"})[n]||n,le=n=>({pending:"รอชำระ",paid:"ชำระแล้ว",failed:"ชำระไม่สำเร็จ",refunded:"คืนเงิน"})[n]||n,ae=n=>({pending:"bg-yellow-100 text-yellow-800",paid:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800",refunded:"bg-gray-100 text-gray-800"})[n]||"bg-gray-100 text-gray-800",$=n=>Me(new Date(n),"dd MMM yyyy HH:mm",{locale:Se}),re=n=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(n),de=async()=>{if(!p.value||p.value.length<2){g.value=[];return}try{const n=await $fetch(`${y.public.apiBase}/admin/users?search=${encodeURIComponent(p.value)}&role=parent&limit=10`,{headers:{Authorization:`Bearer ${v.value}`}});if(n.success){const t=(d.value?.parents||[]).map(C=>C.id);g.value=n.data.filter(C=>!t.includes(C.id))}}catch(n){console.error("Error searching parent:",n),g.value=[]}},ie=n=>{f.value=n,p.value=`${n.first_name} ${n.last_name} (${n.username})`,g.value=[]},K=()=>{z.value=!1,f.value=null,p.value="",_.value="guardian",k.value="",g.value=[]},ue=async()=>{if(f.value){H.value=!0,k.value="";try{(await $fetch(`${y.public.apiBase}/admin/students/${j}/parents`,{method:"POST",headers:{Authorization:`Bearer ${v.value}`},body:{parent_id:f.value.id,relationship:_.value}})).success&&(await A(),K())}catch(n){console.error("Error adding parent:",n),k.value=n.data?.message||"เกิดข้อผิดพลาดในการเพิ่มผู้ปกครอง"}finally{H.value=!1}}},me=n=>{c.value=n,i.first_name=n.first_name,i.last_name=n.last_name,i.email=n.email||"",i.phone=n.phone||"",i.relationship=n.relationship||"guardian",w.value=""},ce=async()=>{if(c.value){V.value=!0,w.value="";try{await $fetch(`${y.public.apiBase}/admin/users/${c.value.id}`,{method:"PUT",headers:{Authorization:`Bearer ${v.value}`},body:{email:i.email||null,first_name:i.first_name,last_name:i.last_name,phone:i.phone||null}}),i.relationship!==c.value.relationship&&await $fetch(`${y.public.apiBase}/admin/students/${j}/parents/${c.value.id}`,{method:"PATCH",headers:{Authorization:`Bearer ${v.value}`},body:{relationship:i.relationship}}),await A(),c.value=null}catch(n){console.error("Error editing parent:",n),w.value=n.data?.message||"เกิดข้อผิดพลาดในการแก้ไขข้อมูลผู้ปกครอง"}finally{V.value=!1}}};return ke(()=>{A()}),(n,t)=>{const C=xe,pe=ye;return l(),a("div",null,[e("div",je,[e("div",Ee,[e("button",{onClick:t[0]||(t[0]=s=>n.$router.back()),class:"p-2 hover:bg-gray-100 rounded-lg"},[...t[12]||(t[12]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),t[13]||(t[13]=e("h1",{class:"text-3xl font-bold"},"รายละเอียดผู้เรียน",-1))]),e("div",Ne,[o(L)?(l(),a("button",{key:0,onClick:te,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2"},[...t[14]||(t[14]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),e("span",null,"แก้ไข",-1)])])):m("",!0)])]),o(T)?(l(),a("div",ze,[...t[15]||(t[15]=[e("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"},null,-1),e("p",{class:"mt-4 text-gray-600"},"กำลังโหลดข้อมูล...",-1)])])):o(E)?(l(),a("div",He,r(o(E)),1)):o(d)?(l(),a("div",Ve,[e("div",Ae,[e("div",Ue,[t[16]||(t[16]=e("h2",{class:"text-xl font-semibold"},"ข้อมูลผู้เรียน",-1)),e("span",{class:U(["px-3 py-1 text-sm font-medium rounded",G(o(d).student.status)])},r(O(o(d).student.status)),3)]),e("div",Re,[e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"ชื่อ-นามสกุล",-1)),e("p",Te,r(o(d).student.first_name)+" "+r(o(d).student.last_name),1)]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"Username",-1)),e("p",De,r(o(d).student.username),1)]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"Email",-1)),e("p",Ie,r(o(d).student.email||"-"),1)]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"เบอร์โทรศัพท์",-1)),e("p",qe,r(o(d).student.phone||"-"),1)]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"วันที่สร้าง",-1)),e("p",Le,r($(o(d).student.created_at)),1)]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"อัปเดตล่าสุด",-1)),e("p",Fe,r($(o(d).student.updated_at)),1)])])]),e("div",Je,[e("div",Oe,[t[24]||(t[24]=e("h2",{class:"text-xl font-semibold"},"ผู้ปกครอง",-1)),o(L)?(l(),a("button",{key:0,onClick:t[1]||(t[1]=s=>z.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2"},[...t[23]||(t[23]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("span",null,"เพิ่มผู้ปกครอง",-1)])])):m("",!0)]),o(d).parents&&o(d).parents.length>0?(l(),a("div",Ge,[(l(!0),a(B,null,P(o(d).parents,s=>(l(),a("div",{key:s.id,class:"border border-gray-200 rounded-lg p-4"},[e("div",Ke,[e("div",Qe,[e("h3",We,r(s.first_name)+" "+r(s.last_name),1),e("span",Xe,r(ne(s.relationship)),1)]),o(L)?(l(),a("div",Ye,[e("button",{onClick:ge=>me(s),class:"px-3 py-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"แก้ไขผู้ปกครอง"},[...t[25]||(t[25]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,Ze)])):m("",!0)]),e("div",et,[e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"Username",-1)),e("p",tt,r(s.username),1)]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"Email",-1)),e("p",st,r(s.email||"-"),1)]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"เบอร์โทรศัพท์",-1)),e("p",nt,r(s.phone||"-"),1)]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-500 mb-1"},"สถานะ",-1)),e("span",{class:U(["px-2 py-1 text-xs font-medium rounded",G(s.status)])},r(O(s.status)),3)])])]))),128))])):(l(),a("div",ot,[...t[30]||(t[30]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("p",{class:"mt-2"},"ไม่มีข้อมูลผู้ปกครอง",-1)])]))]),e("div",lt,[t[36]||(t[36]=e("h2",{class:"text-xl font-semibold mb-4"},"คอร์สที่ลงทะเบียน",-1)),o(d).enrollments&&o(d).enrollments.length>0?(l(),a("div",at,[(l(!0),a(B,null,P(o(d).enrollments,s=>(l(),a("div",{key:s.id,class:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors"},[e("div",rt,[e("div",dt,[e("div",it,[e("h3",ut,r(s.course.title),1),e("span",{class:U(["px-2 py-1 text-xs font-medium rounded",s.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"])},r(oe(s.status)),3)]),e("div",mt,[e("div",null,[t[31]||(t[31]=e("span",{class:"text-gray-500"},"รหัสคอร์ส:",-1)),e("span",ct,r(s.course.code),1)]),e("div",null,[t[32]||(t[32]=e("span",{class:"text-gray-500"},"สาขา:",-1)),e("span",pt,r(s.branch.name),1)]),e("div",null,[t[33]||(t[33]=e("span",{class:"text-gray-500"},"วันที่ลงทะเบียน:",-1)),e("span",gt,r($(s.enrolled_at)),1)])])]),Ce(C,{to:`/admin/enrollments/${s.id}`,class:"ml-4 px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},{default:Be(()=>[...t[34]||(t[34]=[S(" ดูรายละเอียด ",-1)])]),_:1},8,["to"])])]))),128))])):(l(),a("div",xt,[...t[35]||(t[35]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})],-1),e("p",{class:"mt-2"},"ยังไม่ได้ลงทะเบียนคอร์สใดๆ",-1)])]))]),o(D)&&o(D).length>0?(l(),a("div",yt,[t[37]||(t[37]=e("h2",{class:"text-xl font-semibold mb-4"},"ความคืบหน้าการเรียน",-1)),e("div",vt,[(l(!0),a(B,null,P(o(D),s=>(l(),a("div",{key:s.id,class:"border border-gray-200 rounded-lg p-4"},[e("div",bt,[e("h3",ft,r(s.course_title),1),e("span",ht,r(s.completion_percentage)+"%",1)]),e("div",_t,[e("div",{class:"bg-green-600 h-2 rounded-full transition-all",style:Pe({width:`${s.completion_percentage}%`})},null,4)]),e("div",kt," เรียนแล้ว "+r(s.completed_sessions)+" / "+r(s.total_sessions)+" บทเรียน ",1)]))),128))])])):m("",!0),o(F)?(l(),a("div",wt,[t[41]||(t[41]=e("h2",{class:"text-xl font-semibold mb-4"},"ประวัติการชำระเงิน",-1)),o(I)?(l(),a("div",$t,[...t[38]||(t[38]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"},null,-1),e("p",{class:"mt-2 text-gray-600"},"กำลังโหลดข้อมูล...",-1)])])):o(h)&&o(h).length>0?(l(),a("div",Ct,[e("table",Bt,[t[39]||(t[39]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"วันที่ชำระ"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"จำนวนเงิน"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"วิธีการชำระ"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"รหัสคอร์ส"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"สาขา"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"สถานะ")])],-1)),e("tbody",Pt,[(l(!0),a(B,null,P(o(h),s=>(l(),a("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Mt,r(s.payment_date?$(s.payment_date):$(s.created_at)),1),e("td",St,r(re(s.amount)),1),e("td",jt,r(s.payment_method_name),1),e("td",Et,[s.enrollment?(l(),a("span",Nt,r(s.enrollment.course.code),1)):(l(),a("span",zt,"-"))]),e("td",Ht,[s.enrollment?(l(),a("span",Vt,r(s.enrollment.branch.name),1)):(l(),a("span",At,"-"))]),e("td",Ut,[e("span",{class:U(["px-2 py-1 text-xs font-medium rounded",ae(s.status)])},r(le(s.status)),3)])]))),128))])])])):(l(),a("div",Rt,[...t[40]||(t[40]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("p",{class:"mt-2"},"ไม่มีประวัติการชำระเงิน",-1)])]))])):m("",!0)])):m("",!0),o(z)?(l(),a("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:t[4]||(t[4]=R(s=>z.value=!1,["self"]))},[e("div",Tt,[t[45]||(t[45]=e("h3",{class:"text-lg font-semibold mb-4"},"เพิ่มผู้ปกครอง",-1)),e("form",{onSubmit:R(ue,["prevent"]),class:"space-y-4"},[e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," ค้นหาผู้ปกครอง (Username หรือ Email) ",-1)),x(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>W(p)?p.value=s:null),type:"text",placeholder:"กรอก username หรือ email",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",onInput:de},null,544),[[M,o(p)]]),o(g).length>0?(l(),a("div",Dt,[(l(!0),a(B,null,P(o(g),s=>(l(),a("button",{key:s.id,type:"button",onClick:ge=>ie(s),class:"w-full text-left px-4 py-2 hover:bg-gray-100 border-b border-gray-100 last:border-b-0"},[e("div",qt,r(s.first_name)+" "+r(s.last_name),1),e("div",Lt,r(s.username)+" - "+r(s.email||"-"),1)],8,It))),128))])):m("",!0)]),o(f)?(l(),a("div",Ft,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[S(" ความสัมพันธ์ "),e("span",{class:"text-red-500"},"*")],-1)),x(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>W(_)?_.value=s:null),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},[...t[43]||(t[43]=[e("option",{value:"father"},"บิดา",-1),e("option",{value:"mother"},"มารดา",-1),e("option",{value:"guardian"},"ผู้ปกครอง",-1),e("option",{value:"other"},"อื่นๆ",-1)])],512),[[X,o(_)]])])):m("",!0),o(k)?(l(),a("div",Jt,r(o(k)),1)):m("",!0),e("div",Ot,[e("button",{type:"button",onClick:K,class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100"}," ยกเลิก "),e("button",{type:"submit",disabled:!o(f)||o(H),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed"},[o(H)?(l(),a("span",Kt,"กำลังเพิ่ม...")):(l(),a("span",Qt,"เพิ่ม"))],8,Gt)])],32)])])):m("",!0),o(c)?(l(),a("div",{key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:t[11]||(t[11]=R(s=>c.value=null,["self"]))},[e("div",Wt,[t[52]||(t[52]=e("h3",{class:"text-lg font-semibold mb-4"},"แก้ไขผู้ปกครอง",-1)),e("form",{onSubmit:R(ce,["prevent"]),class:"space-y-4"},[e("div",null,[t[46]||(t[46]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[S(" ชื่อ "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>o(i).first_name=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[M,o(i).first_name]])]),e("div",null,[t[47]||(t[47]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[S(" นามสกุล "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>o(i).last_name=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[M,o(i).last_name]])]),e("div",null,[t[48]||(t[48]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Email ",-1)),x(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>o(i).email=s),type:"email",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[M,o(i).email]])]),e("div",null,[t[49]||(t[49]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," เบอร์โทรศัพท์ ",-1)),x(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>o(i).phone=s),type:"tel",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[M,o(i).phone]])]),e("div",null,[t[51]||(t[51]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[S(" ความสัมพันธ์ "),e("span",{class:"text-red-500"},"*")],-1)),x(e("select",{"onUpdate:modelValue":t[9]||(t[9]=s=>o(i).relationship=s),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},[...t[50]||(t[50]=[e("option",{value:"father"},"บิดา",-1),e("option",{value:"mother"},"มารดา",-1),e("option",{value:"guardian"},"ผู้ปกครอง",-1),e("option",{value:"other"},"อื่นๆ",-1)])],512),[[X,o(i).relationship]])]),o(w)?(l(),a("div",Xt,r(o(w)),1)):m("",!0),e("div",Yt,[e("button",{type:"button",onClick:t[10]||(t[10]=s=>c.value=null),class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100"}," ยกเลิก "),e("button",{type:"submit",disabled:o(V),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed"},[o(V)?(l(),a("span",es,"กำลังบันทึก...")):(l(),a("span",ts,"บันทึก"))],8,Zt)])],32)])])):m("",!0),o(N)?(l(),we(pe,{key:5,show:o(N),student:o(q),onClose:J,onSaved:se},null,8,["show","student"])):m("",!0)])}}});export{ds as default};
