import{d as h,l as S,r as b,q as C,E as V,c as n,b as t,v as c,x as i,y as m,e as o,g as _,t as g,L as x,s as U,a as l}from"./CX4WDIMJ.js";const M={class:"bg-white rounded-lg shadow p-6"},T={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},q={class:"md:col-span-2"},A={key:0,class:"mt-1 text-xs text-gray-500"},B={key:0,class:"mt-1 text-xs text-gray-500"},E={class:"flex items-center space-x-4"},I={class:"flex items-center"},N={class:"flex items-center"},P={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},K={class:"flex justify-end space-x-3 pt-4"},$=["disabled"],D={key:0},j={key:1},G=h({__name:"StripeConfig",props:{gatewayConfig:{},paymentMethodId:{}},emits:["saved"],setup(d,{emit:f}){const y=d,w=f,{accessToken:v}=S(),p=b(!1),u=b(""),s=C({gateway_code:"stripe",gateway_name:"Stripe",api_key:"",api_secret:"",webhook_secret:"",is_test_mode:!0,is_active:!1});V(()=>y.gatewayConfig,a=>{a?(s.gateway_code=a.gateway_code||"stripe",s.gateway_name=a.gateway_name||"Stripe",s.api_key=a.api_key||"",s.is_test_mode=a.is_test_mode!==void 0?a.is_test_mode:!0,s.is_active=a.is_active!==void 0?a.is_active:!1):(s.gateway_code="stripe",s.gateway_name="Stripe",s.api_key="",s.api_secret="",s.webhook_secret="",s.is_test_mode=!0,s.is_active=!1),u.value=""},{immediate:!0});const k=async()=>{p.value=!0,u.value="";try{await $fetch(`/api/admin/settings/payment-methods/${y.paymentMethodId}/gateway`,{method:"PUT",headers:{Authorization:`Bearer ${v.value}`},body:s}),w("saved")}catch(a){console.error("Error saving Stripe config:",a),u.value=a.data?.message||"เกิดข้อผิดพลาดในการบันทึกข้อมูล"}finally{p.value=!1}};return(a,e)=>(l(),n("div",M,[e[12]||(e[12]=t("h3",{class:"text-lg font-semibold mb-4"},"การตั้งค่า Stripe",-1)),t("form",{onSubmit:U(k,["prevent"]),class:"space-y-4"},[t("div",T,[t("div",q,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Gateway Name ",-1)),i(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>o(s).gateway_name=r),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[m,o(s).gateway_name]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[_(" Publishable Key (API Key) "),t("span",{class:"text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>o(s).api_key=r),type:"text",required:"",placeholder:"pk_test_...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 font-mono text-sm"},null,512),[[m,o(s).api_key]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[_(" Secret Key (API Secret) "),t("span",{class:"text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>o(s).api_secret=r),type:"password",required:"",placeholder:"sk_test_...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 font-mono text-sm"},null,512),[[m,o(s).api_secret]]),d.gatewayConfig?.api_secret?(l(),n("p",A," ปัจจุบัน: "+g(d.gatewayConfig.api_secret)+" (กรอกเฉพาะเมื่อต้องการเปลี่ยน) ",1)):c("",!0)]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Webhook Secret ",-1)),i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>o(s).webhook_secret=r),type:"password",placeholder:"whsec_...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 font-mono text-sm"},null,512),[[m,o(s).webhook_secret]]),d.gatewayConfig?.webhook_secret?(l(),n("p",B," ปัจจุบัน: "+g(d.gatewayConfig.webhook_secret)+" (กรอกเฉพาะเมื่อต้องการเปลี่ยน) ",1)):c("",!0)])]),t("div",E,[t("label",I,[i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>o(s).is_test_mode=r),type:"checkbox",class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,512),[[x,o(s).is_test_mode]]),e[10]||(e[10]=t("span",{class:"ml-2 text-sm text-gray-700"},"Test Mode (ใช้คีย์ทดสอบ)",-1))]),t("label",N,[i(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>o(s).is_active=r),type:"checkbox",class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,512),[[x,o(s).is_active]]),e[11]||(e[11]=t("span",{class:"ml-2 text-sm text-gray-700"},"เปิดใช้งาน",-1))])]),o(u)?(l(),n("div",P,g(o(u)),1)):c("",!0),t("div",K,[t("button",{type:"submit",disabled:o(p),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed"},[o(p)?(l(),n("span",D,"กำลังบันทึก...")):(l(),n("span",j,"บันทึก"))],8,$)])],32)]))}});export{G as _};
