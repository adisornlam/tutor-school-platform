import{d as y,l as _,r as w,q as v,E as k,c as u,b as s,s as q,x as n,y as d,e as o,L as i,v as h,g as V,a as m}from"./CX4WDIMJ.js";const U={class:"space-y-6"},T={class:"bg-white rounded-lg shadow p-6"},S={class:"border-b border-gray-200 pb-4"},A={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},B={class:"border-b border-gray-200 pb-4"},E={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},N={class:"mt-4 space-y-2"},j={class:"flex items-center"},C={class:"flex items-center"},M={class:"flex items-center"},P={class:"flex items-center"},$={class:"border-b border-gray-200 pb-4"},F={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},L={class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},z={class:"relative inline-flex items-center cursor-pointer"},D={class:"flex justify-end pt-4"},O=["disabled"],G={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},I=y({__name:"SecurityTab",props:{settings:{}},emits:["saved"],setup(p,{emit:g}){const b=p,f=g,{accessToken:c}=_(),a=w(!1),t=v({session_timeout:120,password_min_length:8,password_require_uppercase:!1,password_require_lowercase:!1,password_require_number:!1,password_require_special:!1,login_attempts_limit:5,login_lockout_duration:15,two_factor_auth_enabled:!1});k(()=>b.settings,l=>{l&&l.length>0&&l.forEach(e=>{const r=e.key;r in t&&(typeof t[r]=="number"?t[r]=Number(e.value)||t[r]:typeof t[r]=="boolean"?t[r]=e.value||!1:t[r]=e.value||t[r])})},{immediate:!0});const x=async()=>{try{a.value=!0;const l=Object.keys(t).map(e=>({key:e,value:t[e]}));await $fetch("/api/admin/settings/system",{method:"PUT",headers:{Authorization:`Bearer ${c.value}`},body:{settings:l}}),f("saved")}catch(l){console.error("Error saving security settings:",l),alert(l.data?.message||"เกิดข้อผิดพลาดในการบันทึกการตั้งค่า")}finally{a.value=!1}};return(l,e)=>(m(),u("div",U,[s("div",T,[e[25]||(e[25]=s("h2",{class:"text-xl font-semibold mb-4"},"การตั้งค่าความปลอดภัย",-1)),s("form",{onSubmit:q(x,["prevent"]),class:"space-y-6"},[s("div",S,[e[11]||(e[11]=s("h3",{class:"text-lg font-medium mb-4"},"Session Settings",-1)),s("div",A,[s("div",null,[e[9]||(e[9]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Session Timeout (นาที) ",-1)),n(s("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>o(t).session_timeout=r),type:"number",min:"5",max:"480",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:""},null,512),[[d,o(t).session_timeout,void 0,{number:!0}]]),e[10]||(e[10]=s("p",{class:"mt-1 text-sm text-gray-500"},"ระยะเวลาหมดอายุของ session",-1))])])]),s("div",B,[e[17]||(e[17]=s("h3",{class:"text-lg font-medium mb-4"},"Password Policy",-1)),s("div",E,[s("div",null,[e[12]||(e[12]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," ความยาวรหัสผ่านขั้นต่ำ ",-1)),n(s("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>o(t).password_min_length=r),type:"number",min:"6",max:"32",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:""},null,512),[[d,o(t).password_min_length,void 0,{number:!0}]])])]),s("div",N,[s("label",j,[n(s("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>o(t).password_require_uppercase=r),type:"checkbox",class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,512),[[i,o(t).password_require_uppercase]]),e[13]||(e[13]=s("span",{class:"ml-2 text-sm text-gray-700"},"ต้องมีตัวพิมพ์ใหญ่",-1))]),s("label",C,[n(s("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>o(t).password_require_lowercase=r),type:"checkbox",class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,512),[[i,o(t).password_require_lowercase]]),e[14]||(e[14]=s("span",{class:"ml-2 text-sm text-gray-700"},"ต้องมีตัวพิมพ์เล็ก",-1))]),s("label",M,[n(s("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>o(t).password_require_number=r),type:"checkbox",class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,512),[[i,o(t).password_require_number]]),e[15]||(e[15]=s("span",{class:"ml-2 text-sm text-gray-700"},"ต้องมีตัวเลข",-1))]),s("label",P,[n(s("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>o(t).password_require_special=r),type:"checkbox",class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,512),[[i,o(t).password_require_special]]),e[16]||(e[16]=s("span",{class:"ml-2 text-sm text-gray-700"},"ต้องมีตัวอักษรพิเศษ (!@#$%^&*)",-1))])])]),s("div",$,[e[20]||(e[20]=s("h3",{class:"text-lg font-medium mb-4"},"Login Security",-1)),s("div",F,[s("div",null,[e[18]||(e[18]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," จำนวนครั้งที่พยายาม login ได้ ",-1)),n(s("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>o(t).login_attempts_limit=r),type:"number",min:"3",max:"10",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:""},null,512),[[d,o(t).login_attempts_limit,void 0,{number:!0}]])]),s("div",null,[e[19]||(e[19]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," ระยะเวลาที่ถูก lock (นาที) ",-1)),n(s("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>o(t).login_lockout_duration=r),type:"number",min:"5",max:"60",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:""},null,512),[[d,o(t).login_lockout_duration,void 0,{number:!0}]])])])]),s("div",null,[e[23]||(e[23]=s("h3",{class:"text-lg font-medium mb-4"},"Two-Factor Authentication",-1)),s("div",L,[e[22]||(e[22]=s("div",null,[s("label",{class:"block text-sm font-medium text-gray-700"}," เปิดใช้งาน 2FA สำหรับ admin "),s("p",{class:"text-sm text-gray-500 mt-1"}," ต้องใช้การยืนยันตัวตน 2 ขั้นตอนสำหรับ admin ")],-1)),s("label",z,[n(s("input",{"onUpdate:modelValue":e[8]||(e[8]=r=>o(t).two_factor_auth_enabled=r),type:"checkbox",class:"sr-only peer"},null,512),[[i,o(t).two_factor_auth_enabled]]),e[21]||(e[21]=s("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"},null,-1))])])]),s("div",D,[s("button",{type:"submit",disabled:o(a),class:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center"},[o(a)?(m(),u("span",G)):h("",!0),e[24]||(e[24]=V(" บันทึก ",-1))],8,O)])],32)])]))}});export{I as _};
