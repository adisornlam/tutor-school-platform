import{d as x,l as v,r as _,q as w,E as h,c as i,b as t,s as k,x as a,L as d,e as o,y as u,v as V,g as T,a as f}from"./CX4WDIMJ.js";const U={class:"space-y-6"},M={class:"bg-white rounded-lg shadow p-6"},N={class:"border-b border-gray-200 pb-4"},j={class:"space-y-4"},B={class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},E={class:"relative inline-flex items-center cursor-pointer"},S={class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},q={class:"relative inline-flex items-center cursor-pointer"},C={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},A={class:"flex justify-end pt-4"},$=["disabled"],z={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},L=x({__name:"NotificationTab",props:{settings:{}},emits:["saved"],setup(m,{emit:b}){const p=m,c=b,{accessToken:g}=v(),l=_(!1),s=w({email_notifications_enabled:!0,sms_notifications_enabled:!1,course_reminder_before_minutes:60,payment_reminder_before_days:3});h(()=>p.settings,n=>{n&&n.length>0&&n.forEach(e=>{const r=e.key;r in s&&(typeof s[r]=="number"?s[r]=Number(e.value)||s[r]:typeof s[r]=="boolean"?s[r]=e.value||!1:s[r]=e.value||s[r])})},{immediate:!0});const y=async()=>{try{l.value=!0;const n=Object.keys(s).map(e=>({key:e,value:s[e]}));await $fetch("/api/admin/settings/system",{method:"PUT",headers:{Authorization:`Bearer ${g.value}`},body:{settings:n}}),c("saved")}catch(n){console.error("Error saving notification settings:",n),alert(n.data?.message||"เกิดข้อผิดพลาดในการบันทึกการตั้งค่า")}finally{l.value=!1}};return(n,e)=>(f(),i("div",U,[t("div",M,[e[15]||(e[15]=t("h2",{class:"text-xl font-semibold mb-4"},"การตั้งค่าการแจ้งเตือน",-1)),t("form",{onSubmit:k(y,["prevent"]),class:"space-y-6"},[t("div",N,[e[8]||(e[8]=t("h3",{class:"text-lg font-medium mb-4"},"ช่องทางการแจ้งเตือน",-1)),t("div",j,[t("div",B,[e[5]||(e[5]=t("div",null,[t("label",{class:"block text-sm font-medium text-gray-700"}," อีเมล "),t("p",{class:"text-sm text-gray-500 mt-1"}," เปิดใช้งานการแจ้งเตือนทางอีเมล ")],-1)),t("label",E,[a(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>o(s).email_notifications_enabled=r),type:"checkbox",class:"sr-only peer"},null,512),[[d,o(s).email_notifications_enabled]]),e[4]||(e[4]=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"},null,-1))])]),t("div",S,[e[7]||(e[7]=t("div",null,[t("label",{class:"block text-sm font-medium text-gray-700"}," SMS "),t("p",{class:"text-sm text-gray-500 mt-1"}," เปิดใช้งานการแจ้งเตือนทาง SMS ")],-1)),t("label",q,[a(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>o(s).sms_notifications_enabled=r),type:"checkbox",class:"sr-only peer"},null,512),[[d,o(s).sms_notifications_enabled]]),e[6]||(e[6]=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"},null,-1))])])])]),t("div",null,[e[13]||(e[13]=t("h3",{class:"text-lg font-medium mb-4"},"การแจ้งเตือนอัตโนมัติ",-1)),t("div",C,[t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," แจ้งเตือนก่อนคอร์สเริ่ม (นาที) ",-1)),a(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>o(s).course_reminder_before_minutes=r),type:"number",min:"5",max:"1440",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:""},null,512),[[u,o(s).course_reminder_before_minutes,void 0,{number:!0}]]),e[10]||(e[10]=t("p",{class:"mt-1 text-sm text-gray-500"},"ส่งการแจ้งเตือนก่อนคอร์สเริ่มกี่นาที",-1))]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," แจ้งเตือนก่อนวันชำระเงิน (วัน) ",-1)),a(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>o(s).payment_reminder_before_days=r),type:"number",min:"1",max:"30",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:""},null,512),[[u,o(s).payment_reminder_before_days,void 0,{number:!0}]]),e[12]||(e[12]=t("p",{class:"mt-1 text-sm text-gray-500"},"ส่งการแจ้งเตือนก่อนวันชำระเงินกี่วัน",-1))])])]),t("div",A,[t("button",{type:"submit",disabled:o(l),class:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center"},[o(l)?(f(),i("span",z)):V("",!0),e[14]||(e[14]=T(" บันทึก ",-1))],8,$)])],32)])]))}});export{L as _};
