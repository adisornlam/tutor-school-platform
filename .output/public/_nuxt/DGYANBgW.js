import{_ as D}from"./D87qWK56.js";import{d as L,u as H,m as R,r as i,q as E,o as F,c as d,b as o,x as f,y as O,e as s,H as x,J as h,F as T,i as P,t as b,v as z,g as $,j as I,a as l,k as A}from"./B_rLn4hw.js";import"./BlVozWiI.js";const J={class:"min-h-screen bg-gray-50"},K={class:"bg-white border-b border-gray-200 sticky top-0 z-10 shadow-sm"},Q={class:"container mx-auto px-4 py-4"},G={class:"flex flex-col md:flex-row gap-4"},W={class:"flex-1"},X={class:"relative"},Y=["disabled"],Z=["value"],ee={key:0,class:"container mx-auto px-4 py-12"},oe={key:1,class:"container mx-auto px-4 py-12"},te={class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-center"},se={key:2,class:"container mx-auto px-4 py-8"},ne={class:"mb-6"},re={class:"text-gray-600"},ae={class:"font-semibold text-gray-900"},le={key:0,class:"text-center py-16"},ie={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},de={key:2,class:"mt-8 bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 rounded-lg shadow-sm"},ue={class:"text-sm text-gray-700"},ce={class:"flex space-x-2"},pe=["disabled"],ge=["disabled"],fe=L({__name:"index",setup(ve){H({title:"คอร์สเรียนทั้งหมด - KDC School"});const B=I(),a=R(),_=i([]),w=i(!0),m=i(null),n=E({page:1,limit:15,total:0,totalPages:0}),p=i(""),g=i(""),v=i(""),u=i(""),y=i("newest"),S=i([]),k=i(!1);let C=null;const M=()=>{C&&clearTimeout(C),C=setTimeout(()=>{n.page=1,c()},500)},N=async()=>{k.value=!0;try{const t=await $fetch(`${B.public.apiBase}/branches`);t.success&&(S.value=t.data)}catch(t){console.error("Error loading branches:",t)}finally{k.value=!1}},c=async()=>{w.value=!0,m.value=null;try{const t={page:n.page.toString(),limit:n.limit.toString()};p.value&&(t.search=p.value),g.value&&(t.type=g.value),v.value&&(t.level=v.value),u.value&&(t.branch_id=u.value),y.value&&(t.sort_by=y.value),a.query.category,a.query.branch_id&&(t.branch_id=a.query.branch_id,u.value=a.query.branch_id);const e=new URLSearchParams(t).toString(),q=`${B.public.apiBase}/courses?${e}`,r=await $fetch(q);r.success?(_.value=r.data,Object.assign(n,r.pagination)):m.value="ไม่สามารถโหลดข้อมูลคอร์สได้"}catch(t){console.error("Error loading courses:",t),m.value=t.data?.message||"เกิดข้อผิดพลาดในการโหลดข้อมูลคอร์ส"}finally{w.value=!1}},V=t=>{n.page=t,c(),window.scrollTo({top:0,behavior:"smooth"})},U=t=>({id:t.id,title:t.title,description:t.description,price:t.price,thumbnail:t.thumbnail_url||void 0,type:j(t.type),students:t.enrollment_count,rating:void 0,originalPrice:void 0}),j=t=>({live_online:"Live Online",vod:"Video on Demand",hybrid:"Hybrid"})[t]||t;return F(async()=>{await N(),a.query.search&&(p.value=a.query.search),a.query.type&&(g.value=a.query.type),a.query.level&&(v.value=a.query.level),a.query.branch_id&&(u.value=a.query.branch_id),a.query.sort_by&&(y.value=a.query.sort_by),c()}),(t,e)=>{const q=D;return l(),d("div",J,[e[20]||(e[20]=o("section",{class:"bg-gradient-to-br from-green-500 to-green-700 text-white py-12"},[o("div",{class:"container mx-auto px-4"},[o("h1",{class:"text-4xl font-bold mb-4"},"คอร์สเรียนทั้งหมด"),o("p",{class:"text-lg text-green-100"},"เลือกคอร์สที่เหมาะสมกับคุณ")])],-1)),o("section",K,[o("div",Q,[o("div",G,[o("div",W,[o("div",X,[f(o("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>x(p)?p.value=r:null),type:"text",placeholder:"ค้นหาคอร์ส...",class:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",onInput:M},null,544),[[O,s(p)]]),e[11]||(e[11]=o("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),f(o("select",{"onUpdate:modelValue":e[1]||(e[1]=r=>x(g)?g.value=r:null),onChange:e[2]||(e[2]=()=>{s(n).page=1,c()}),class:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},[...e[12]||(e[12]=[o("option",{value:""},"ทุกประเภท",-1),o("option",{value:"live_online"},"Live Online",-1),o("option",{value:"vod"},"Video on Demand",-1),o("option",{value:"hybrid"},"Hybrid",-1)])],544),[[h,s(g)]]),f(o("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>x(v)?v.value=r:null),onChange:e[4]||(e[4]=()=>{s(n).page=1,c()}),class:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},[...e[13]||(e[13]=[o("option",{value:""},"ทุกระดับ",-1),o("option",{value:"beginner"},"Beginner",-1),o("option",{value:"intermediate"},"Intermediate",-1),o("option",{value:"advanced"},"Advanced",-1)])],544),[[h,s(v)]]),f(o("select",{"onUpdate:modelValue":e[5]||(e[5]=r=>x(u)?u.value=r:null),onChange:e[6]||(e[6]=()=>{s(n).page=1,c()}),class:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",disabled:s(k)},[e[14]||(e[14]=o("option",{value:""},"ทุกสาขา",-1)),(l(!0),d(T,null,P(s(S),r=>(l(),d("option",{key:r.id,value:r.id.toString()},b(r.name),9,Z))),128))],40,Y),[[h,s(u)]]),f(o("select",{"onUpdate:modelValue":e[7]||(e[7]=r=>x(y)?y.value=r:null),onChange:e[8]||(e[8]=()=>{s(n).page=1,c()}),class:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},[...e[15]||(e[15]=[o("option",{value:"newest"},"ใหม่ล่าสุด",-1),o("option",{value:"popular"},"ยอดนิยม",-1),o("option",{value:"price_asc"},"ราคา: ต่ำ-สูง",-1),o("option",{value:"price_desc"},"ราคา: สูง-ต่ำ",-1)])],544),[[h,s(y)]])])])]),s(w)?(l(),d("div",ee,[...e[16]||(e[16]=[o("div",{class:"text-center"},[o("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"}),o("p",{class:"mt-4 text-gray-600"},"กำลังโหลดข้อมูล...")],-1)])])):s(m)?(l(),d("div",oe,[o("div",te,b(s(m)),1)])):(l(),d("section",se,[o("div",ne,[o("p",re,[e[17]||(e[17]=$(" พบ ",-1)),o("span",ae,b(s(n).total),1),e[18]||(e[18]=$(" คอร์ส ",-1))])]),s(_).length===0?(l(),d("div",le,[...e[19]||(e[19]=[o("svg",{class:"mx-auto h-16 w-16 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})],-1),o("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"ไม่พบคอร์สเรียน",-1),o("p",{class:"text-gray-600"},"ลองเปลี่ยนเงื่อนไขการค้นหาหรือตัวกรอง",-1)])])):(l(),d("div",ie,[(l(!0),d(T,null,P(s(_),r=>(l(),A(q,{key:r.id,course:U(r)},null,8,["course"]))),128))])),s(n).totalPages>1?(l(),d("div",de,[o("div",ue," แสดง "+b((s(n).page-1)*s(n).limit+1)+" ถึง "+b(Math.min(s(n).page*s(n).limit,s(n).total))+" จาก "+b(s(n).total)+" รายการ ",1),o("div",ce,[o("button",{onClick:e[9]||(e[9]=r=>V(s(n).page-1)),disabled:s(n).page===1,class:"px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100 transition-colors"}," ก่อนหน้า ",8,pe),o("button",{onClick:e[10]||(e[10]=r=>V(s(n).page+1)),disabled:s(n).page>=s(n).totalPages,class:"px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100 transition-colors"}," ถัดไป ",8,ge)])])):z("",!0)]))])}}});export{fe as default};
