import{_ as E}from"./BlVozWiI.js";import{d as T,m as B,p as C,B as N,r as i,o as R,c as r,b as t,f,w as k,t as v,e as o,F as D,v as V,x as a,g as x,y as u,J as P,s as $,a as d}from"./B_rLn4hw.js";import{R as j}from"./Bxq2twJv.js";const O={class:"flex items-center justify-between mb-6"},h={class:"flex items-center space-x-4"},q={class:"text-3xl font-bold"},F={key:0,class:"text-center py-12"},I={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6"},K={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},L={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},J={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},z={class:"flex justify-end space-x-4 pt-4 border-t"},A=["disabled"],G={key:0},H={key:1},Z=T({__name:"edit",setup(Q){const _=B(),U=C(),m=N(()=>_.params.id==="new"?null:parseInt(_.params.id)),w=i(null),g=i(!0),p=i(null),c=i(!1),y=i(null),l=i({slug:"",title:"",content:"",meta_title:"",meta_description:"",meta_keywords:"",is_active:!0,display_order:0}),S=async()=>{if(!m.value){g.value=!1;return}g.value=!0,p.value=null;try{const n=await $fetch("/api/admin/content-pages");if(n.success){const e=n.data.find(b=>b.id===m.value);e?(w.value=e,l.value={slug:e.slug,title:e.title,content:e.content||"",meta_title:e.meta_title||"",meta_description:e.meta_description||"",meta_keywords:e.meta_keywords||"",is_active:e.is_active,display_order:e.display_order}):p.value="ไม่พบหน้าที่ต้องการแก้ไข"}}catch(n){console.error("Error loading page:",n),p.value=n.data?.message||n.message||"ไม่สามารถโหลดข้อมูลได้"}finally{g.value=!1}},M=async()=>{c.value=!0,y.value=null;try{m.value?await $fetch(`/api/admin/content-pages/${m.value}`,{method:"PUT",body:{slug:l.value.slug,title:l.value.title,content:l.value.content||null,meta_title:l.value.meta_title||null,meta_description:l.value.meta_description||null,meta_keywords:l.value.meta_keywords||null,is_active:l.value.is_active,display_order:l.value.display_order}}):await $fetch("/api/admin/content-pages",{method:"POST",body:{slug:l.value.slug,title:l.value.title,content:l.value.content||null,meta_title:l.value.meta_title||null,meta_description:l.value.meta_description||null,meta_keywords:l.value.meta_keywords||null,is_active:l.value.is_active,display_order:l.value.display_order}}),U.push("/admin/content/pages")}catch(n){console.error("Error saving page:",n),y.value=n.data?.message||n.message||"ไม่สามารถบันทึกได้"}finally{c.value=!1}};return R(()=>{S()}),(n,e)=>{const b=E;return d(),r("div",null,[t("div",O,[t("div",h,[f(b,{to:"/admin/content/pages",class:"p-2 hover:bg-gray-100 rounded-lg"},{default:k(()=>[...e[8]||(e[8]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),_:1}),t("h1",q,v(o(w)?"แก้ไขหน้าเว็บไซต์":"เพิ่มหน้าเว็บไซต์ใหม่"),1)])]),o(g)?(d(),r("div",F,[...e[9]||(e[9]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"},null,-1),t("p",{class:"mt-4 text-gray-600"},"กำลังโหลดข้อมูล...",-1)])])):(d(),r(D,{key:1},[o(p)?(d(),r("div",I,v(o(p)),1)):V("",!0),t("form",{onSubmit:$(M,["prevent"]),class:"bg-white rounded-lg shadow p-6 space-y-6"},[t("div",K,[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[x(" Slug "),t("span",{class:"text-red-500"},"*")],-1)),a(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o(l).slug=s),type:"text",required:"",placeholder:"about, contact, help",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 font-mono"},null,512),[[u,o(l).slug]]),e[11]||(e[11]=t("p",{class:"mt-1 text-sm text-gray-500"},"URL path สำหรับหน้าเว็บไซต์ (เช่น: /about, /contact)",-1))]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[x(" ชื่อหน้า "),t("span",{class:"text-red-500"},"*")],-1)),a(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o(l).title=s),type:"text",required:"",placeholder:"เกี่ยวกับเรา",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[u,o(l).title]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," สถานะ ",-1)),a(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>o(l).is_active=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},[...e[13]||(e[13]=[t("option",{value:!0},"ใช้งาน",-1),t("option",{value:!1},"ไม่ใช้งาน",-1)])],512),[[P,o(l).is_active]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," ลำดับการแสดงผล ",-1)),a(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o(l).display_order=s),type:"number",min:"0",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[u,o(l).display_order,void 0,{number:!0}]])])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," เนื้อหา ",-1)),f(j,{modelValue:o(l).content,"onUpdate:modelValue":e[4]||(e[4]=s=>o(l).content=s),"entity-type":"content-pages","entity-id":o(m)||void 0,class:"w-full"},null,8,["modelValue","entity-id"])]),t("div",L,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Meta Title ",-1)),a(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o(l).meta_title=s),type:"text",placeholder:"หน้าเว็บไซต์ - KDC Tutor School",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[u,o(l).meta_title]]),e[18]||(e[18]=t("p",{class:"mt-1 text-sm text-gray-500"},"ใช้สำหรับ SEO (ถ้าไม่กรอกจะใช้ชื่อหน้า)",-1))]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Meta Keywords ",-1)),a(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o(l).meta_keywords=s),type:"text",placeholder:"keyword1, keyword2, keyword3",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[u,o(l).meta_keywords]])])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Meta Description ",-1)),a(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=s=>o(l).meta_description=s),rows:"3",placeholder:"คำอธิบายสั้นๆ สำหรับ SEO",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[u,o(l).meta_description]])]),o(y)?(d(),r("div",J,v(o(y)),1)):V("",!0),t("div",z,[f(b,{to:"/admin/content/pages",class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"},{default:k(()=>[...e[21]||(e[21]=[x(" ยกเลิก ",-1)])]),_:1}),t("button",{type:"submit",disabled:o(c),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"},[o(c)?(d(),r("span",G,"กำลังบันทึก...")):(d(),r("span",H,"บันทึก"))],8,A)])],32)],64))])}}});export{Z as default};
