import{l as h,r as c,E as g,D as l,j as C}from"./CX4WDIMJ.js";const p=()=>{const i=C(),{accessToken:n,user:r}=h(),a=c(0),s=c(!1),u=e=>e.reduce((t,v)=>t+(v.unread_count||0),0),o=async()=>{if(!n.value||!r.value){a.value=0;return}s.value=!0;try{const e=await $fetch(`${i.public.apiBase}/chat/rooms`,{headers:{Authorization:`Bearer ${n.value}`}});e.success&&(a.value=u(e.data))}catch(e){console.error("[UnreadMessages] Error fetching unread count:",e),a.value=0}finally{s.value=!1}},d=e=>{a.value=u(e)},f=()=>{a.value=0};return g([n,r],([e,t])=>{e&&t?o():a.value=0},{immediate:!0}),{unreadCount:l(a),loading:l(s),fetchUnreadCount:o,updateUnreadCount:d,resetUnreadCount:f}},U=globalThis.setInterval;export{U as s,p as u};
