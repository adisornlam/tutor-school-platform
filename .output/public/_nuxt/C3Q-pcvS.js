import{d as k,l as V,r as x,q as C,E as U,c as l,b as s,v as g,x as n,y as d,e as o,g as c,t as y,L as f,s as T,a as i}from"./B_rLn4hw.js";const I={class:"bg-white rounded-lg shadow p-6"},K={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},M={class:"md:col-span-2"},S={key:0,class:"mt-1 text-xs text-gray-500"},A={key:0,class:"mt-1 text-xs text-gray-500"},q={class:"flex items-center space-x-4"},E={class:"flex items-center"},P={class:"flex items-center"},B={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},D={class:"flex justify-end space-x-3 pt-4"},N=["disabled"],Y={key:0},$={key:1},W=k({__name:"KsherConfig",props:{gatewayConfig:{},paymentMethodId:{}},emits:["saved"],setup(u,{emit:_}){const b=u,w=_,{accessToken:h}=V(),p=x(!1),m=x(""),t=C({gateway_code:"ksher",gateway_name:"Ksher Thailand",merchant_id:"",api_key:"",api_secret:"",webhook_secret:"",endpoint_url:"",is_test_mode:!0,is_active:!1});U(()=>b.gatewayConfig,r=>{r?(t.gateway_code=r.gateway_code||"ksher",t.gateway_name=r.gateway_name||"Ksher Thailand",t.merchant_id=r.merchant_id||"",t.api_key=r.api_key||"",t.endpoint_url=r.endpoint_url||"",t.is_test_mode=r.is_test_mode!==void 0?r.is_test_mode:!0,t.is_active=r.is_active!==void 0?r.is_active:!1):(t.gateway_code="ksher",t.gateway_name="Ksher Thailand",t.merchant_id="",t.api_key="",t.api_secret="",t.webhook_secret="",t.endpoint_url="",t.is_test_mode=!0,t.is_active=!1),m.value=""},{immediate:!0});const v=async()=>{p.value=!0,m.value="";try{await $fetch(`/api/admin/settings/payment-methods/${b.paymentMethodId}/gateway`,{method:"PUT",headers:{Authorization:`Bearer ${h.value}`},body:t}),w("saved")}catch(r){console.error("Error saving Ksher config:",r),m.value=r.data?.message||"เกิดข้อผิดพลาดในการบันทึกข้อมูล"}finally{p.value=!1}};return(r,e)=>(i(),l("div",I,[e[16]||(e[16]=s("h3",{class:"text-lg font-semibold mb-4"},"การตั้งค่า Ksher Thailand",-1)),s("form",{onSubmit:T(v,["prevent"]),class:"space-y-4"},[s("div",K,[s("div",M,[e[8]||(e[8]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Gateway Name ",-1)),n(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>o(t).gateway_name=a),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[d,o(t).gateway_name]])]),s("div",null,[e[9]||(e[9]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[c(" Merchant ID "),s("span",{class:"text-red-500"},"*")],-1)),n(s("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>o(t).merchant_id=a),type:"text",required:"",placeholder:"Your Merchant ID",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[d,o(t).merchant_id]])]),s("div",null,[e[10]||(e[10]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[c(" API Key "),s("span",{class:"text-red-500"},"*")],-1)),n(s("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>o(t).api_key=a),type:"text",required:"",placeholder:"Your API Key",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 font-mono text-sm"},null,512),[[d,o(t).api_key]])]),s("div",null,[e[11]||(e[11]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[c(" API Secret "),s("span",{class:"text-red-500"},"*")],-1)),n(s("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>o(t).api_secret=a),type:"password",required:"",placeholder:"Your API Secret",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 font-mono text-sm"},null,512),[[d,o(t).api_secret]]),u.gatewayConfig?.api_secret?(i(),l("p",S," ปัจจุบัน: "+y(u.gatewayConfig.api_secret)+" (กรอกเฉพาะเมื่อต้องการเปลี่ยน) ",1)):g("",!0)]),s("div",null,[e[12]||(e[12]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Webhook Secret ",-1)),n(s("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>o(t).webhook_secret=a),type:"password",placeholder:"Your Webhook Secret",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 font-mono text-sm"},null,512),[[d,o(t).webhook_secret]]),u.gatewayConfig?.webhook_secret?(i(),l("p",A," ปัจจุบัน: "+y(u.gatewayConfig.webhook_secret)+" (กรอกเฉพาะเมื่อต้องการเปลี่ยน) ",1)):g("",!0)]),s("div",null,[e[13]||(e[13]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Endpoint URL ",-1)),n(s("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>o(t).endpoint_url=a),type:"url",placeholder:"https://api.ksher.com",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[d,o(t).endpoint_url]])])]),s("div",q,[s("label",E,[n(s("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>o(t).is_test_mode=a),type:"checkbox",class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,512),[[f,o(t).is_test_mode]]),e[14]||(e[14]=s("span",{class:"ml-2 text-sm text-gray-700"},"Test Mode (ใช้ Sandbox)",-1))]),s("label",P,[n(s("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>o(t).is_active=a),type:"checkbox",class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,512),[[f,o(t).is_active]]),e[15]||(e[15]=s("span",{class:"ml-2 text-sm text-gray-700"},"เปิดใช้งาน",-1))])]),o(m)?(i(),l("div",B,y(o(m)),1)):g("",!0),s("div",D,[s("button",{type:"submit",disabled:o(p),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed"},[o(p)?(i(),l("span",Y,"กำลังบันทึก...")):(i(),l("span",$,"บันทึก"))],8,N)])],32)]))}});export{W as _};
