import{d as k,r as B,l as x,E as A,B as $,c as l,b as o,v as c,a6 as C,t as u,F as V,i as S,e as I,j,a as r,g as q}from"./CX4WDIMJ.js";const E={class:"block text-sm font-medium text-gray-700 mb-2"},L={class:"relative"},N=["value","disabled","required"],F={value:""},T=["value"],z={key:0,class:"mt-1 text-sm text-gray-500"},D=k({__name:"AddressSelect",props:{modelValue:{},userId:{},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!0},placeholder:{default:"เลือกที่อยู่"},hint:{default:""},showAddButton:{type:Boolean,default:!0}},emits:["update:modelValue","add-new"],setup(s,{expose:m,emit:f}){const d=s,p=f,n=B([]),g=j(),{accessToken:h}=x(),i=async()=>{if(!d.userId){n.value=[];return}try{const e=await $fetch(`${g.public.apiBase}/admin/users/${d.userId}/addresses`,{headers:{Authorization:`Bearer ${h.value}`}});e.success&&(n.value=e.data)}catch(e){console.error("Error loading addresses:",e),n.value=[]}},v=e=>{const t=[];e.recipient_name&&t.push(e.recipient_name),e.address_line1&&t.push(e.address_line1),e.district&&t.push(`อ.${e.district}`),e.province&&t.push(`จ.${e.province}`),e.postal_code&&t.push(e.postal_code);const a=t.join(" "),y=e.address_type==="home"?"บ้าน":e.address_type==="work"?"ที่ทำงาน":"อื่นๆ",w=e.is_default?" (หลัก)":"";return`${a} [${y}${w}]`},b=e=>{const t=e.target,a=t.value?parseInt(t.value):null;p("update:modelValue",a)};return A(()=>d.userId,e=>{e?i():n.value=[]},{immediate:!0}),m({loadAddresses:i,reloadAddresses:async()=>{await i()},addresses:$(()=>n.value)}),(e,t)=>(r(),l("div",null,[o("label",E,[C(e.$slots,"label",{},()=>[t[1]||(t[1]=q("ที่อยู่จัดส่ง ",-1)),t[2]||(t[2]=o("span",{class:"text-red-500"},"*",-1))])]),o("div",L,[o("select",{value:s.modelValue,onChange:b,disabled:s.disabled||s.loading,required:s.required,"data-address-select":"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 disabled:bg-gray-100 disabled:cursor-not-allowed bg-white text-gray-900"},[o("option",F,u(s.loading?"กำลังโหลด...":s.placeholder),1),(r(!0),l(V,null,S(I(n),a=>(r(),l("option",{key:a.id,value:a.id},u(v(a)),9,T))),128))],40,N),s.showAddButton?(r(),l("button",{key:0,type:"button",onClick:t[0]||(t[0]=a=>e.$emit("add-new")),class:"absolute right-10 top-1/2 transform -translate-y-1/2 text-green-600 hover:text-green-700",title:"เพิ่มที่อยู่ใหม่"},[...t[3]||(t[3]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])):c("",!0)]),s.hint?(r(),l("p",z,u(s.hint),1)):c("",!0)]))}}),O=Object.assign(D,{__name:"AddressSelect"});export{O as A};
