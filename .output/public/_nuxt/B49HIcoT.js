import{d as X,l as Y,q as Z,r as v,E as W,o as ee,c as i,v as k,b as e,t as m,s as B,x,g as C,y as U,e as n,J as j,F as te,i as se,h as le,f as ne,j as oe,a,L as re,p as ae,k as ie,n as K,M as Q}from"./CX4WDIMJ.js";import{R as de}from"./v-KwyajG.js";import{f as ue}from"./BALXvQ8s.js";import{t as ce}from"./CiM0_A9B.js";const pe={class:"bg-white rounded-lg p-6 max-w-3xl w-full mx-4 max-h-[90vh] overflow-y-auto"},me={class:"flex items-center justify-between mb-6"},ge={class:"text-2xl font-bold"},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ve={class:"md:col-span-2"},be={class:"md:col-span-2"},xe={key:0,class:"text-sm text-gray-500 py-2"},fe={key:1,class:"text-sm text-red-500 py-2 bg-red-50 border border-red-200 rounded p-2"},he={key:2,class:"text-sm text-yellow-600 py-2 bg-yellow-50 border border-yellow-200 rounded p-2"},we={key:3,class:"space-y-2 border border-gray-300 rounded-lg p-3"},ke={class:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-2 rounded"},$e=["value","onChange"],_e={class:"flex-1"},Be={class:"text-sm font-medium text-gray-700"},Ce={key:0,class:"text-xs text-gray-500 ml-1"},Me={key:0,class:"mt-2 ml-6"},Te=["value","onInput"],Ve={key:4,class:"text-xs text-red-500 mt-1"},Le={class:"md:col-span-2"},Ue={class:"space-y-3"},je={key:0,class:"text-sm text-gray-600 py-2"},Ee={key:1,class:"space-y-3"},Ne={class:"aspect-video bg-gray-200 rounded-lg overflow-hidden max-w-2xl"},Se=["src"],Oe={key:2,class:"border-2 border-dashed border-gray-300 rounded-lg p-4"},Pe={class:"md:col-span-2"},Re={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},ze={class:"flex justify-end space-x-3 pt-4"},De=["disabled"],Ae={key:0},He={key:1},Ie=X({__name:"CourseModal",props:{show:{type:Boolean},course:{default:null}},emits:["close","saved"],setup(E,{emit:M}){const y=E,N=M,f=oe(),{accessToken:$}=Y(),o=Z({title:"",description:"",thumbnail_url:"",type:"",price:0,duration_hours:null,level:"",status:"draft",code:"",selectedBranches:[]}),h=v(!1),u=v(!1),d=v(""),w=v(""),p=v([]),g=v({}),T=v(!1),V=v(null),S=async()=>{u.value=!0,w.value="";try{const l=await $fetch(`${f.public.apiBase}/admin/branches`,{headers:{Authorization:`Bearer ${$.value}`}});l.success?(p.value=l.data||[],console.log("[CourseModal] Loaded branches:",p.value.length),p.value.length===0&&(w.value="‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏£‡πå‡∏™")):w.value="‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏Ç‡∏≤‡πÑ‡∏î‡πâ"}catch(l){console.error("[CourseModal] Error loading branches:",l),w.value=l.data?.message||l.message||"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏Ç‡∏≤"}finally{u.value=!1}},O=l=>g.value[l]??"",P=(l,t)=>{const c=t.target.value.trim();if(c==="")g.value[l]=null;else{const r=parseInt(c);!isNaN(r)&&r>0&&(g.value[l]=r)}},R=(l,t)=>{t?l in g.value||(g.value[l]=null):delete g.value[l]},z=async l=>{const t=l.target,s=t.files?.[0];if(!s)return;if(!["image/jpeg","image/png","image/webp"].includes(s.type)){d.value="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (JPG, PNG, WebP ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)";return}if(s.size>2*1024*1024){d.value="‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡∏¥‡∏ô 2 MB (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ < 500 KB)";return}const r=new Image,b=URL.createObjectURL(s);r.onload=async()=>{URL.revokeObjectURL(b);const H=r.width,_=r.height,F=H/_,G=16/9;Math.abs(F-G)>.1&&(d.value=`‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ${H}x${_}) ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ 1280x720 pixels (16:9)`,console.warn(`Image aspect ratio: ${F.toFixed(2)}, recommended: ${G.toFixed(2)}`)),T.value=!0;const q=d.value;d.value="";try{const L=new FormData;L.append("file",s);const J=y.course?.id,I=await $fetch(`${f.public.apiBase}/admin/upload?entityType=courses&fileType=thumbnail${J?`&entityId=${J}`:""}`,{method:"POST",headers:{Authorization:`Bearer ${$.value}`},body:L});I.success&&I.data.url&&(o.thumbnail_url=I.data.url,q.includes("‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°")?d.value=q:d.value="")}catch(L){console.error("Error uploading thumbnail:",L),d.value=L.data?.message||"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û"}finally{T.value=!1,t&&(t.value="")}},r.onerror=()=>{URL.revokeObjectURL(b),d.value="‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ"},r.src=b},D=l=>{const t=l.target;t.style.display="none"};W(()=>y.course,l=>{l?(o.title=l.title,o.description=l.description||"",o.type=l.type,o.price=l.price,o.duration_hours=l.duration_hours||null,o.level=l.level||"",o.status=l.status,o.code=l.code||"",o.thumbnail_url=l.thumbnail_url||"",l.branches&&l.branches.length>0?(o.selectedBranches=l.branches.map(t=>t.branch_id),l.branches.forEach(t=>{t.seat_limit!==null&&t.seat_limit!==void 0&&(g.value[t.branch_id]=t.seat_limit)})):o.selectedBranches=[]):(o.title="",o.description="",o.type="",o.price=0,o.duration_hours=null,o.level="",o.status="draft",o.code="",o.thumbnail_url="",o.selectedBranches=[],g.value={}),d.value="",w.value=""},{immediate:!0}),W(()=>y.show,l=>{l&&(S(),y.course||(g.value={}))},{immediate:!0}),ee(()=>{y.show&&S()});const A=async()=>{if(o.selectedBranches.length===0){d.value="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏™‡∏≤‡∏Ç‡∏≤";return}h.value=!0,d.value="";try{const l={title:o.title,description:o.description||null,type:o.type,price:o.price,duration_hours:o.duration_hours||null,level:o.level||null,status:o.status,branches:o.selectedBranches.map(t=>({branch_id:t,seat_limit:g.value[t]??null,is_available:!0}))};o.code&&(l.code=o.code),o.thumbnail_url&&(l.thumbnail_url=o.thumbnail_url),y.course?await $fetch(`${f.public.apiBase}/admin/courses/${y.course.id}`,{method:"PUT",headers:{Authorization:`Bearer ${$.value}`},body:l}):await $fetch(`${f.public.apiBase}/admin/courses`,{method:"POST",headers:{Authorization:`Bearer ${$.value}`},body:l}),N("saved")}catch(l){console.error("Error saving course:",l),d.value=l.data?.message||"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"}finally{h.value=!1}};return(l,t)=>E.show?(a(),i("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:t[13]||(t[13]=B(s=>l.$emit("close"),["self"]))},[e("div",pe,[e("div",me,[e("h2",ge,m(E.course?"‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏≠‡∏£‡πå‡∏™":"‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏£‡πå‡∏™"),1),e("button",{onClick:t[0]||(t[0]=s=>l.$emit("close")),class:"text-gray-400 hover:text-gray-600"},[...t[14]||(t[14]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:B(A,["prevent"]),class:"space-y-4"},[e("div",ye,[e("div",ve,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[C(" ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏£‡πå‡∏™ "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>n(o).title=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏£‡πå‡∏™"},null,512),[[U,n(o).title]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," ‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏≠‡∏£‡πå‡∏™ ",-1)),x(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n(o).code=s),type:"text",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"‡πÄ‡∏ä‡πà‡∏ô COURSE001"},null,512),[[U,n(o).code]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[C(" ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó "),e("span",{class:"text-red-500"},"*")],-1)),x(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>n(o).type=s),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},[...t[17]||(t[17]=[e("option",{value:""},"‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó",-1),e("option",{value:"live_online"},"Live Online",-1),e("option",{value:"vod"},"VOD",-1),e("option",{value:"hybrid"},"Hybrid",-1)])],512),[[j,n(o).type]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[C(" ‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó) "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>n(o).price=s),type:"number",step:"0.01",min:"0",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"0.00"},null,512),[[U,n(o).price,void 0,{number:!0}]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á) ",-1)),x(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>n(o).duration_hours=s),type:"number",min:"0",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"0"},null,512),[[U,n(o).duration_hours,void 0,{number:!0}]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," ‡∏£‡∏∞‡∏î‡∏±‡∏ö ",-1)),x(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>n(o).level=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},[...t[21]||(t[21]=[e("option",{value:""},"‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö",-1),e("option",{value:"beginner"},"‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô",-1),e("option",{value:"intermediate"},"‡∏Å‡∏•‡∏≤‡∏á",-1),e("option",{value:"advanced"},"‡∏™‡∏π‡∏á",-1)])],512),[[j,n(o).level]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[C(" ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "),e("span",{class:"text-red-500"},"*")],-1)),x(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>n(o).status=s),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},[...t[23]||(t[23]=[e("option",{value:"draft"},"‡∏£‡πà‡∏≤‡∏á",-1),e("option",{value:"published"},"‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà",-1),e("option",{value:"archived"},"‡πÄ‡∏Å‡πá‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£",-1)])],512),[[j,n(o).status]])]),e("div",be,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[C(" ‡∏™‡∏≤‡∏Ç‡∏≤ "),e("span",{class:"text-red-500"},"*")],-1)),n(u)?(a(),i("div",xe," ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏Ç‡∏≤... ")):n(w)?(a(),i("div",fe,m(n(w)),1)):n(p).length===0?(a(),i("div",he," ‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏≤‡∏Ç‡∏≤ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏£‡πå‡∏™ ")):(a(),i("div",we,[(a(!0),i(te,null,se(n(p),s=>(a(),i("div",{key:s.id,class:"border-b border-gray-200 pb-3 last:border-b-0 last:pb-0"},[e("label",ke,[x(e("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":t[8]||(t[8]=c=>n(o).selectedBranches=c),onChange:c=>R(s.id,n(o).selectedBranches.includes(s.id)),class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,40,$e),[[re,n(o).selectedBranches]]),e("div",_e,[e("span",Be,m(s.name),1),s.code?(a(),i("span",Ce,"("+m(s.code)+")",1)):k("",!0)])]),n(o).selectedBranches.includes(s.id)?(a(),i("div",Me,[t[25]||(t[25]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"}," ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö (‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á) ",-1)),e("input",{type:"number",value:O(s.id),onInput:c=>P(s.id,c),min:"1",class:"w-full px-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î (‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á)"},null,40,Te),t[26]||(t[26]=e("p",{class:"text-xs text-gray-500 mt-1"},"‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á",-1))])):k("",!0)]))),128))])),n(o).selectedBranches.length===0&&!n(u)&&n(p).length>0?(a(),i("p",Ve," ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏™‡∏≤‡∏Ç‡∏≤ ")):k("",!0)]),e("div",Le,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏õ‡∏Å ",-1)),e("div",Ue,[t[30]||(t[30]=le('<div class="bg-blue-50 border border-blue-200 rounded-lg p-4"><p class="text-sm font-semibold text-blue-900 mb-2">üìê ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</p><ul class="text-sm text-blue-800 space-y-1 list-disc list-inside"><li><strong>‡∏Ç‡∏ô‡∏≤‡∏î:</strong> 1280 x 720 pixels</li><li><strong>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô:</strong> 16:9 (‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô)</li><li><strong>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö:</strong> JPG, PNG, WebP</li><li><strong>‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå:</strong> ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 2 MB (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ &lt; 500 KB)</li></ul></div>',1)),n(T)?(a(),i("div",je," ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î... ")):n(o).thumbnail_url?(a(),i("div",Ee,[e("div",Ne,[e("img",{src:n(o).thumbnail_url,alt:"Thumbnail preview",class:"w-full h-full object-cover",onError:D},null,40,Se)]),e("button",{type:"button",onClick:t[9]||(t[9]=s=>n(o).thumbnail_url=""),class:"px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg border border-red-200"}," ‡∏•‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ")])):(a(),i("div",Oe,[e("input",{ref_key:"thumbnailInput",ref:V,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:z,class:"hidden"},null,544),e("button",{type:"button",onClick:t[10]||(t[10]=s=>l.$refs.thumbnailInput?.click()),class:"w-full px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"},[...t[28]||(t[28]=[e("svg",{class:"w-5 h-5 inline-block mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),C(" ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏õ‡∏Å ",-1)])]),t[29]||(t[29]=e("p",{class:"text-xs text-gray-500 mt-2 text-center"},"‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå: JPG, PNG, WebP (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2 MB)",-1))]))])]),e("div",Pe,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ ",-1)),ne(de,{modelValue:n(o).description,"onUpdate:modelValue":t[11]||(t[11]=s=>n(o).description=s),"entity-type":"courses","entity-id":y.course?.id,class:"w-full"},null,8,["modelValue","entity-id"])])]),n(d)?(a(),i("div",Re,m(n(d)),1)):k("",!0),e("div",ze,[e("button",{type:"button",onClick:t[12]||(t[12]=s=>l.$emit("close")),class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100"}," ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å "),e("button",{type:"submit",disabled:n(h),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed"},[n(h)?(a(),i("span",Ae,"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...")):(a(),i("span",He,"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å"))],8,De)])],32)])])):k("",!0)}}),Fe=Object.assign(Ie,{__name:"CourseModal"}),Ge={class:"flex items-center justify-between mb-6"},qe={class:"bg-white rounded-lg shadow p-4 mb-6"},Je={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},We={class:"bg-white rounded-lg shadow overflow-hidden"},Ke={key:0,class:"p-8 text-center"},Qe={key:1,class:"p-4 bg-red-50 border border-red-200 text-red-700 rounded"},Xe={key:2,class:"p-8 text-center text-gray-500"},Ye={key:3,class:"min-w-full divide-y divide-gray-200"},Ze={class:"bg-white divide-y divide-gray-200"},et=["onClick"],tt={class:"text-sm font-medium text-green-600 hover:text-green-700 cursor-pointer"},st={key:0,class:"text-xs text-gray-500"},ot={key:1,class:"text-xs text-gray-400 mt-1 line-clamp-2"},lt={class:"px-6 py-4 whitespace-nowrap"},nt={class:"px-6 py-4 whitespace-nowrap"},rt={class:"text-sm font-medium text-gray-900"},at={class:"px-6 py-4 whitespace-nowrap"},it={key:0,class:"text-sm text-gray-600"},dt={key:1,class:"text-sm text-gray-400"},ut={class:"px-6 py-4 whitespace-nowrap"},ct={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},pt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},mt={class:"flex items-center justify-end space-x-2"},gt=["onClick"],yt=["onClick"],vt=["onClick"],bt=["onClick"],xt=["onClick"],_t=X({__name:"index",setup(E){const M=oe(),{accessToken:y}=Y(),N=ae(),f=v([]),$=v(!0),o=v(""),h=v(!1),u=Z({search:"",type:"",status:""});let d=null;const w=()=>{d&&clearTimeout(d),d=setTimeout(()=>{p()},500)},p=async()=>{$.value=!0,o.value="";try{const t={};u.search&&(t.search=u.search),u.type&&(t.type=u.type),u.status&&(t.status=u.status);const s=await $fetch(`${M.public.apiBase}/admin/courses`,{headers:{Authorization:`Bearer ${y.value}`},params:t});s.success&&(f.value=s.data)}catch(t){console.error("Error loading courses:",t),o.value=t.data?.message||"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"}finally{$.value=!1}},g=()=>{h.value=!1},T=async()=>{g(),await p()},V=async(t,s,c)=>{const r=f.value.find(_=>_.id===t);if(!r)return;const{confirm:b}=Q();if(await b({title:`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô${c}`,message:`‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£${c}‡∏Ñ‡∏≠‡∏£‡πå‡∏™ ${r.title}?`,confirmText:c,cancelText:"‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å",type:s==="published"?"info":"warning"}))try{await $fetch(`${M.public.apiBase}/admin/courses/${t}/status`,{method:"PATCH",headers:{Authorization:`Bearer ${y.value}`},body:{status:s}}),await p()}catch(_){console.error("Error updating status:",_),alert(_.data?.message||"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞")}},S=async t=>{const{confirm:s}=Q();if(await s({title:"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö",message:`‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ñ‡∏≠‡∏£‡πå‡∏™ ${t.title}?
‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ`,confirmText:"‡∏•‡∏ö",cancelText:"‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å",type:"danger"}))try{await $fetch(`${M.public.apiBase}/admin/courses/${t.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${y.value}`}}),await p()}catch(r){console.error("Error deleting course:",r),alert(r.data?.message||"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ñ‡∏≠‡∏£‡πå‡∏™")}},O=t=>({live_online:"Live Online",vod:"VOD",hybrid:"Hybrid"})[t]||t,P=t=>({live_online:"bg-blue-100 text-blue-800",vod:"bg-purple-100 text-purple-800",hybrid:"bg-indigo-100 text-indigo-800"})[t]||"bg-gray-100 text-gray-800",R=t=>({draft:"‡∏£‡πà‡∏≤‡∏á",published:"‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà",archived:"‡πÄ‡∏Å‡πá‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£"})[t]||t,z=t=>({draft:"bg-gray-100 text-gray-800",published:"bg-green-100 text-green-800",archived:"bg-yellow-100 text-yellow-800"})[t]||"bg-gray-100 text-gray-800",D=t=>({beginner:"‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô",intermediate:"‡∏Å‡∏•‡∏≤‡∏á",advanced:"‡∏™‡∏π‡∏á"})[t]||t,A=t=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(t),l=t=>ue(new Date(t),"dd MMM yyyy",{locale:ce});return ee(()=>{p()}),(t,s)=>{const c=Fe;return a(),i("div",null,[e("div",Ge,[s[5]||(s[5]=e("h1",{class:"text-3xl font-bold"},"‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡πÄ‡∏£‡∏µ‡∏¢‡∏ô",-1)),e("button",{onClick:s[0]||(s[0]=r=>h.value=!0),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2"},[...s[4]||(s[4]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("span",null,"‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏£‡πå‡∏™",-1)])])]),e("div",qe,[e("div",Je,[e("div",null,[s[6]||(s[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤",-1)),x(e("input",{"onUpdate:modelValue":s[1]||(s[1]=r=>n(u).search=r),type:"text",placeholder:"‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏£‡πå‡∏™, ‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏≠‡∏£‡πå‡∏™",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",onInput:w},null,544),[[U,n(u).search]])]),e("div",null,[s[8]||(s[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó",-1)),x(e("select",{"onUpdate:modelValue":s[2]||(s[2]=r=>n(u).type=r),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",onChange:p},[...s[7]||(s[7]=[e("option",{value:""},"‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",-1),e("option",{value:"live_online"},"Live Online",-1),e("option",{value:"vod"},"VOD",-1),e("option",{value:"hybrid"},"Hybrid",-1)])],544),[[j,n(u).type]])]),e("div",null,[s[10]||(s[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞",-1)),x(e("select",{"onUpdate:modelValue":s[3]||(s[3]=r=>n(u).status=r),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",onChange:p},[...s[9]||(s[9]=[e("option",{value:""},"‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",-1),e("option",{value:"draft"},"‡∏£‡πà‡∏≤‡∏á",-1),e("option",{value:"published"},"‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà",-1),e("option",{value:"archived"},"‡πÄ‡∏Å‡πá‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£",-1)])],544),[[j,n(u).status]])])])]),e("div",We,[n($)?(a(),i("div",Ke,[...s[11]||(s[11]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"},null,-1),e("p",{class:"mt-2 text-gray-600"},"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...",-1)])])):n(o)?(a(),i("div",Qe,m(n(o)),1)):n(f).length===0?(a(),i("div",Xe," ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ")):(a(),i("table",Ye,[s[17]||(s[17]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"‡∏Ñ‡∏≠‡∏£‡πå‡∏™"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"‡∏£‡∏≤‡∏Ñ‡∏≤"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"‡∏£‡∏∞‡∏î‡∏±‡∏ö"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£")])],-1)),e("tbody",Ze,[(a(!0),i(te,null,se(n(f),r=>(a(),i("tr",{key:r.id,class:"hover:bg-gray-50"},[e("td",{class:"px-6 py-4 cursor-pointer",onClick:b=>n(N).push(`/admin/courses/${r.id}`)},[e("div",null,[e("div",tt,m(r.title),1),r.code?(a(),i("div",st,"‡∏£‡∏´‡∏±‡∏™: "+m(r.code),1)):k("",!0),r.description?(a(),i("div",ot,m(r.description),1)):k("",!0)])],8,et),e("td",lt,[e("span",{class:K(["px-2 py-1 text-xs font-medium rounded",P(r.type)])},m(O(r.type)),3)]),e("td",nt,[e("span",rt,m(A(r.price)),1)]),e("td",at,[r.level?(a(),i("span",it,m(D(r.level)),1)):(a(),i("span",dt,"-"))]),e("td",ut,[e("span",{class:K(["px-2 py-1 text-xs font-medium rounded",z(r.status)])},m(R(r.status)),3)]),e("td",ct,m(l(r.created_at)),1),e("td",pt,[e("div",mt,[e("button",{onClick:B(b=>n(N).push(`/admin/courses/${r.id}/edit`),["stop"]),class:"text-green-600 hover:text-green-900",title:"‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç"},[...s[12]||(s[12]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,gt),r.status==="published"?(a(),i("button",{key:0,onClick:B(b=>V(r.id,"archived","‡πÄ‡∏Å‡πá‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£"),["stop"]),class:"text-yellow-600 hover:text-yellow-900",title:"‡πÄ‡∏Å‡πá‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£"},[...s[13]||(s[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})],-1)])],8,yt)):r.status==="archived"?(a(),i("button",{key:1,onClick:B(b=>V(r.id,"published","‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà"),["stop"]),class:"text-green-600 hover:text-green-900",title:"‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà"},[...s[14]||(s[14]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)])],8,vt)):r.status==="draft"?(a(),i("button",{key:2,onClick:B(b=>V(r.id,"published","‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà"),["stop"]),class:"text-blue-600 hover:text-blue-900",title:"‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà"},[...s[15]||(s[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)])],8,bt)):k("",!0),e("button",{onClick:B(b=>S(r),["stop"]),class:"text-red-600 hover:text-red-900",title:"‡∏•‡∏ö"},[...s[16]||(s[16]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,xt)])])]))),128))])]))]),n(h)?(a(),ie(c,{key:0,show:n(h),course:null,onClose:g,onSaved:T},null,8,["show"])):k("",!0)])}}});export{_t as default};
