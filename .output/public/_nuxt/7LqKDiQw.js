import{_ as B}from"./CSRImk1W.js";import{d as E,l as j,M as T,r as i,o as V,c as n,b as e,f as z,e as r,t as l,F as I,i as L,a,n as N,v as m,g as u}from"./B_rLn4hw.js";const S={class:"space-y-6"},D={class:"flex items-center justify-between"},H={key:0,class:"text-center py-8"},q={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},F={key:2,class:"text-center py-8 text-gray-500"},Q={key:3,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},R={class:"flex items-start justify-between"},G={class:"flex-1"},J={class:"flex items-center gap-2 mb-2"},K={class:"font-semibold text-lg"},O={key:0,class:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded"},P={class:"text-sm text-gray-600 space-y-1"},U={key:0},W={key:0,class:"mt-3"},X=["src"],Y={class:"flex flex-col gap-2 ml-4"},Z=["onClick"],ee=["onClick"],oe=E({__name:"BankAccountsSection",props:{paymentMethodId:{}},emits:["saved"],setup(g,{emit:k}){const _=g,y=k,{accessToken:b}=j(),{confirm:w}=T(),v=i(!1),d=i(null),p=i([]),h=i(!1),c=i(null),f=async()=>{try{v.value=!0,d.value=null;const o=await $fetch(`/api/admin/settings/payment-methods/${_.paymentMethodId}/bank-accounts`,{headers:{Authorization:`Bearer ${b.value}`}});o.success?p.value=o.data:d.value="ไม่สามารถโหลดบัญชีธนาคารได้"}catch(o){console.error("Error loading bank accounts:",o),d.value=o.data?.message||"เกิดข้อผิดพลาดในการโหลดบัญชีธนาคาร"}finally{v.value=!1}},C=o=>{c.value=o},$=async o=>{if(await w({title:"ลบบัญชีธนาคาร",message:`คุณต้องการลบบัญชี "${o.bank_name} - ${o.account_number}" หรือไม่?`,confirmText:"ลบ",cancelText:"ยกเลิก",variant:"danger"}))try{await $fetch(`/api/admin/settings/payment-methods/${_.paymentMethodId}/bank-accounts/${o.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${b.value}`}}),await f(),y("saved")}catch(s){console.error("Error deleting bank account:",s),alert(s.data?.message||"เกิดข้อผิดพลาดในการลบ")}},x=()=>{c.value=null,h.value=!1},M=()=>{x(),f(),y("saved")};return V(()=>{f()}),(o,t)=>(a(),n("div",S,[e("div",D,[t[1]||(t[1]=e("h3",{class:"text-lg font-semibold"},"บัญชีธนาคาร",-1)),e("button",{onClick:t[0]||(t[0]=s=>h.value=!0),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm"}," เพิ่มบัญชีธนาคาร ")]),r(v)?(a(),n("div",H,[...t[2]||(t[2]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"},null,-1),e("p",{class:"mt-2 text-gray-600"},"กำลังโหลด...",-1)])])):r(d)?(a(),n("div",q,l(r(d)),1)):r(p).length===0?(a(),n("div",F," ยังไม่มีบัญชีธนาคาร ")):(a(),n("div",Q,[(a(!0),n(I,null,L(r(p),s=>(a(),n("div",{key:s.id,class:N(["border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",{"border-green-500 bg-green-50":s.is_default}])},[e("div",R,[e("div",G,[e("div",J,[e("h4",K,l(s.bank_name),1),s.is_default?(a(),n("span",O," ค่าเริ่มต้น ")):m("",!0)]),e("div",P,[e("p",null,[t[3]||(t[3]=e("span",{class:"font-medium"},"ชื่อบัญชี:",-1)),u(" "+l(s.account_name),1)]),e("p",null,[t[4]||(t[4]=e("span",{class:"font-medium"},"เลขบัญชี:",-1)),u(" "+l(s.account_number),1)]),s.branch_name?(a(),n("p",U,[t[5]||(t[5]=e("span",{class:"font-medium"},"สาขา:",-1)),u(" "+l(s.branch_name),1)])):m("",!0),e("p",null,[t[6]||(t[6]=e("span",{class:"font-medium"},"ประเภท:",-1)),u(" "+l(s.account_type==="savings"?"ออมทรัพย์":"กระแสรายวัน"),1)])]),s.qr_code_url?(a(),n("div",W,[e("img",{src:s.qr_code_url,alt:"QR Code",class:"w-32 h-32 object-contain border border-gray-200 rounded"},null,8,X)])):m("",!0)]),e("div",Y,[e("button",{onClick:A=>C(s),class:"text-blue-600 hover:text-blue-900",title:"แก้ไข"},[...t[7]||(t[7]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,Z),s.is_default?m("",!0):(a(),n("button",{key:0,onClick:A=>$(s),class:"text-red-600 hover:text-red-900",title:"ลบ"},[...t[8]||(t[8]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ee))])])],2))),128))])),z(B,{show:r(h)||!!r(c),account:r(c),"payment-method-id":g.paymentMethodId,onClose:x,onSaved:M},null,8,["show","account","payment-method-id"])]))}});export{oe as _};
