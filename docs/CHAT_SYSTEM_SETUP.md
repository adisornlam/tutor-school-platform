# Chat System Setup Guide

## тЬЕ р╕кр╕Цр╕▓р╕Щр╕░р╕гр╕░р╕Ър╕Ъ

р╕гр╕░р╕Ър╕Ър╣Бр╕Кр╕Чр╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Бр╕ер╣Йр╕з! р╕Ыр╕гр╕░р╕Бр╕нр╕Ър╕Фр╣Йр╕зр╕в:

### Backend Infrastructure
- тЬЕ Database tables (chat_rooms, chat_messages, chat_room_participants)
- тЬЕ Socket.IO server plugin р╕Юр╕гр╣Йр╕нр╕б Redis adapter
- тЬЕ Chat service (business logic)
- тЬЕ API endpoints (user & admin)
- тЬЕ File upload р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕Кр╕Ч

### Frontend Components
- тЬЕ `useChat` composable - р╕Ир╕▒р╕Фр╕Бр╕▓р╕г Socket.IO connection
- тЬЕ `ChatRoomList.vue` - р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕лр╣Йр╕нр╕Зр╣Бр╕Кр╕Ч
- тЬЕ `ChatMessage.vue` - р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б
- тЬЕ `ChatInput.vue` - Input р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Юр╕┤р╕бр╕Юр╣Мр╣Бр╕ер╕░р╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М
- тЬЕ `ChatWindow.vue` - р╕лр╕Щр╣Йр╕▓р╕Хр╣Ир╕▓р╕Зр╣Бр╕Кр╕Чр╕лр╕ер╕▒р╕Б

### Pages
- тЬЕ `/chat` - р╕лр╕Щр╣Йр╕▓р╕лр╕ер╕▒р╕Бр╕кр╕│р╕лр╕гр╕▒р╕Ъ Student/Tutor
- тЬЕ `/admin/chat` - Admin: р╕Фр╕╣р╣Бр╕Кр╕Чр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
- тЬЕ `/admin/chat/[roomId]` - Admin: р╕Фр╕╣р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Бр╕Кр╕Ч

## ЁЯФз Configuration

### Environment Variables

р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Др╕Яр╕ер╣М `.env` р╕Вр╕нр╕Зр╕Др╕╕р╕Ур╕бр╕╡р╕Др╣Ир╕▓р╣Ар╕лр╕ер╣Ир╕▓р╕Щр╕╡р╣Й:

```env
# Redis Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Socket.IO Configuration (optional)
NUXT_PUBLIC_SITE_URL=http://localhost:4000
```

### Redis Setup

Redis р╕Др╕зр╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕зр╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╕Бр╣Ир╕нр╕Щр╕лр╕Щр╣Йр╕▓ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Фр╣Йр╕зр╕в:

```bash
redis-cli ping
# р╕Др╕зр╕гр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ: PONG
```

## ЁЯУ▒ р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### р╕кр╕│р╕лр╕гр╕▒р╕Ъ Student/Tutor

1. р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╕Фр╣Йр╕зр╕вр╕Ър╕▒р╕Нр╕Кр╕╡ Student р╕лр╕гр╕╖р╕н Tutor
2. р╣Др╕Ыр╕Чр╕╡р╣И `/chat` р╕лр╕гр╕╖р╕нр╕Др╕ер╕┤р╕Бр╣Ар╕бр╕Щр╕╣р╣Бр╕Кр╕Ч
3. р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕гр╕▓р╕вр╕Бр╕▓р╕гр╕лр╣Йр╕нр╕Зр╣Бр╕Кр╕Чр╕Чр╕╡р╣Ир╕бр╕╡р╕нр╕вр╕╣р╣И
4. р╕Др╕ер╕┤р╕Бр╣Ар╕ер╕╖р╕нр╕Бр╕лр╣Йр╕нр╕Зр╣Бр╕Кр╕Чр╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕гр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕кр╕Щр╕Чр╕Щр╕▓
5. р╕Юр╕┤р╕бр╕Юр╣Мр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕ер╕░р╕Бр╕Фр╕кр╣Ир╕З р╕лр╕гр╕╖р╕нр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М/р╕гр╕╣р╕Ыр╕ар╕▓р╕Ю

### р╕кр╕│р╕лр╕гр╕▒р╕Ъ Admin (admincenter р╕Вр╕╢р╣Йр╕Щр╣Др╕Ы)

1. р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╕Фр╣Йр╕зр╕вр╕Ър╕▒р╕Нр╕Кр╕╡ Admin
2. р╣Др╕Ыр╕Чр╕╡р╣И `/admin/chat` р╕лр╕гр╕╖р╕нр╕Др╕ер╕┤р╕Бр╣Ар╕бр╕Щр╕╣ "р╣Бр╕Кр╕Ч" р╣Гр╕Щ sidebar
3. р╕Фр╕╣р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕лр╣Йр╕нр╕Зр╣Бр╕Кр╕Чр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
4. р╕Др╕ер╕┤р╕Б "р╕Фр╕╣р╣Бр╕Кр╕Ч" р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Бр╕▓р╕гр╕кр╕Щр╕Чр╕Щр╕▓
5. р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Фр╕╣р╣Бр╕Кр╕Чр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╣Гр╕Щр╕гр╕░р╕Ър╕Ър╣Др╕Фр╣Й

## ЁЯОп Features

### Real-time Messaging
- тЬЕ р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕Ър╕Ъ real-time
- тЬЕ Typing indicator
- тЬЕ Read receipts
- тЬЕ Unread message count

### File Support
- тЬЕ р╕нр╕▒р╕Юр╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю (JPG, PNG, GIF, WebP)
- тЬЕ р╕нр╕▒р╕Юр╣Вр╕лр╕ер╕Фр╣Др╕Яр╕ер╣М (PDF, DOC, DOCX, XLS, XLSX, TXT)
- тЬЕ Preview р╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Гр╕Щр╣Бр╕Кр╕Ч
- тЬЕ Download р╣Др╕Яр╕ер╣Мр╣Бр╕Щр╕Ъ

### Room Management
- тЬЕ р╕кр╕гр╣Йр╕▓р╕Зр╕лр╣Йр╕нр╕Зр╣Бр╕Кр╕Чр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤р╣Ар╕бр╕╖р╣Ир╕нр╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╣Бр╕ер╕░р╕нр╕▓р╕Ир╕▓р╕гр╕вр╣Мр╣Ар╕гр╕┤р╣Ир╕бр╕кр╕Щр╕Чр╕Щр╕▓
- тЬЕ р╣Бр╕Хр╣Ир╕ер╕░р╕Др╕нр╕гр╣Мр╕кр╕бр╕╡р╕лр╣Йр╕нр╕Зр╣Бр╕Кр╕Чр╣Бр╕вр╕Бр╕Бр╕▒р╕Щ
- тЬЕ Admin р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Фр╕╣р╣Бр╕Кр╕Чр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╣Др╕Фр╣Й

## ЁЯФТ Security

- тЬЕ Authentication required (JWT token)
- тЬЕ Room access verification (р╣Ар╕Йр╕Юр╕▓р╕░р╕Ьр╕╣р╣Йр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕Зр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ)
- тЬЕ Admin role check р╕кр╕│р╕лр╕гр╕▒р╕Ъ admin endpoints
- тЬЕ File upload validation (type, size)

## ЁЯЪА Development

### Start Development Server

```bash
# р╣Ар╕гр╕┤р╣Ир╕б Redis (р╕Цр╣Йр╕▓р╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕гр╕▒р╕Щ)
brew services start redis

# р╣Ар╕гр╕┤р╣Ир╕б dev server
bun run dev
```

### Test Chat System

1. р╣Ар╕Ыр╕┤р╕Ф browser 2 windows (р╕лр╕гр╕╖р╕нр╣Гр╕Кр╣Й incognito mode)
2. Login р╣Ар╕Ыр╣Зр╕Щ Student р╣Гр╕Щ window р╣Бр╕гр╕Б
3. Login р╣Ар╕Ыр╣Зр╕Щ Tutor р╣Гр╕Щ window р╕Чр╕╡р╣Ир╕кр╕нр╕З
4. р╣Др╕Ыр╕Чр╕╡р╣И `/chat` р╣Гр╕Щр╕Чр╕▒р╣Йр╕Зр╕кр╕нр╕З windows
5. р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Чр╕Фр╕кр╕нр╕Ъ

## ЁЯУК Monitoring

### Redis Commands

```bash
# р╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щ Redis
redis-cli

# р╕Фр╕╣ keys р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
KEYS *

# р╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕е Socket.IO rooms
KEYS socket.io*

# р╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕е chat
KEYS chat:*
```

### Socket.IO Events

р╕гр╕░р╕Ър╕Ър╣Гр╕Кр╣Й Socket.IO events р╕Фр╕▒р╕Зр╕Щр╕╡р╣Й:

- `connection` - р╣Ар╕бр╕╖р╣Ир╕н client р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н
- `disconnect` - р╣Ар╕бр╕╖р╣Ир╕н client р╕Хр╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н
- `join_room` - р╣Ар╕Вр╣Йр╕▓р╕гр╣Ир╕зр╕бр╕лр╣Йр╕нр╕Зр╣Бр╕Кр╕Ч
- `leave_room` - р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕лр╣Йр╕нр╕Зр╣Бр╕Кр╕Ч
- `send_message` - р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б
- `typing` - р╣Бр╕кр╕Фр╕Зр╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕│р╕ер╕▒р╕Зр╕Юр╕┤р╕бр╕Юр╣М
- `stop_typing` - р╕лр╕вр╕╕р╕Фр╣Бр╕кр╕Фр╕Зр╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕│р╕ер╕▒р╕Зр╕Юр╕┤р╕бр╕Юр╣М
- `mark_read` - р╕Чр╕│р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕лр╕бр╕▓р╕вр╕зр╣Ир╕▓р╕нр╣Ир╕▓р╕Щр╣Бр╕ер╣Йр╕з
- `new_message` - р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Гр╕лр╕бр╣И (broadcast)
- `new_message_notification` - р╕Бр╕▓р╕гр╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Гр╕лр╕бр╣И

## ЁЯРЫ Troubleshooting

### Redis Connection Error

```bash
# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ Redis р╕Чр╕│р╕Зр╕▓р╕Щ
redis-cli ping

# р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╣Др╕Фр╣Й р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Бр╕ер╕░р╣Ар╕гр╕┤р╣Ир╕б Redis
brew services start redis
```

### Socket.IO р╣Др╕бр╣Ир╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н

1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ server р╕гр╕▒р╕Щр╕нр╕вр╕╣р╣И
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ CORS settings р╣Гр╕Щ `server/plugins/socket.io.ts`
3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ browser console р╕кр╕│р╕лр╕гр╕▒р╕Ъ error messages

### р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Др╕бр╣Ир╣Бр╕кр╕Фр╕З

1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ Redis р╕Чр╕│р╕Зр╕▓р╕Щ
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ database connection
3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ server logs

## ЁЯУЭ Notes

- р╕гр╕░р╕Ър╕Ър╕гр╕нр╕Зр╕гр╕▒р╕Ъ Redis р╕кр╕│р╕лр╕гр╕▒р╕Ъ scaling р╕Ьр╣Ир╕▓р╕Щ multiple instances
- р╕лр╕▓р╕Б Redis р╣Др╕бр╣Ир╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Гр╕Кр╣Й in-memory adapter р╣Бр╕Чр╕Щ (р╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Йр╣Бр╕Хр╣Ир╣Др╕бр╣И scale р╣Др╕Фр╣Й)
- File uploads р╕Цр╕╣р╕Бр╣Ар╕Бр╣Зр╕Ър╣Др╕зр╣Йр╕Чр╕╡р╣И `public/uploads/chat/{roomId}/images/` р╕лр╕гр╕╖р╕н `files/`
- Messages р╕Цр╕╣р╕Бр╣Ар╕Бр╣Зр╕Ър╣Др╕зр╣Йр╣Гр╕Щ database р╣Бр╕ер╕░ cache р╣Гр╕Щ Redis

## ЁЯФД Next Steps

### Planned Features
- [ ] Message search
- [ ] Message reactions
- [ ] Voice messages
- [ ] Video calls (future)
- [ ] Chat history export

